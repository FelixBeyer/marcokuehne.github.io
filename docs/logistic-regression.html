<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Logistic Regression | Becoming Fluent in Data</title>
  <meta name="description" content="A guide to become fluent in data." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Logistic Regression | Becoming Fluent in Data" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/warning.png" />
  <meta property="og:description" content="A guide to become fluent in data." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Logistic Regression | Becoming Fluent in Data" />
  
  <meta name="twitter:description" content="A guide to become fluent in data." />
  <meta name="twitter:image" content="/images/warning.png" />

<meta name="author" content="Marco Kühne" />


<meta name="date" content="2022-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/icons8-trading-64.ico" type="image/x-icon" />
<link rel="prev" href="regression.html"/>
<link rel="next" href="fixed-effects.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://marcokuehne.github.io/">Becoming Fluent in Data</a></li> <li><p class="aligncenter"> <img src="images/icons8-trading-64.png"> </p></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Dust and Dark</a></li>
<li class="part"><span><b>I Preface</b></span></li>
<li class="chapter" data-level="" data-path="teach-learn-repeat.html"><a href="teach-learn-repeat.html"><i class="fa fa-check"></i>Teach – Learn – Repeat</a></li>
<li class="chapter" data-level="" data-path="aim-of-this-books.html"><a href="aim-of-this-books.html"><i class="fa fa-check"></i>Aim of this books</a></li>
<li class="chapter" data-level="" data-path="structure-of-this-books.html"><a href="structure-of-this-books.html"><i class="fa fa-check"></i>Structure of this books</a>
<ul>
<li class="chapter" data-level="" data-path="structure-of-this-books.html"><a href="structure-of-this-books.html#content"><i class="fa fa-check"></i>Content</a></li>
<li class="chapter" data-level="" data-path="structure-of-this-books.html"><a href="structure-of-this-books.html#color"><i class="fa fa-check"></i>Color</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the author</a></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html"><i class="fa fa-check"></i><b>1</b> Data is everywhere</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#why-we-measure"><i class="fa fa-check"></i><b>1.1</b> Why we measure</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#women-are-having-far-fewer-children."><i class="fa fa-check"></i><b>1.1.1</b> Women are having far fewer children.</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#global-surface-temperature-is-rising."><i class="fa fa-check"></i><b>1.1.2</b> Global surface temperature is rising.</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#how-we-measure"><i class="fa fa-check"></i><b>1.2</b> How we measure</a></li>
<li class="chapter" data-level="1.3" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#types-of-data"><i class="fa fa-check"></i><b>1.3</b> Types of data</a></li>
<li class="chapter" data-level="1.4" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#the-reality-behind-the-data"><i class="fa fa-check"></i><b>1.4</b> The reality behind the data</a></li>
<li class="chapter" data-level="1.5" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#data-sources"><i class="fa fa-check"></i><b>1.5</b> Data sources</a></li>
<li class="chapter" data-level="1.6" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#dataset-collections"><i class="fa fa-check"></i><b>1.6</b> Dataset collections</a></li>
<li class="chapter" data-level="1.7" data-path="data-is-everywhere.html"><a href="data-is-everywhere.html#open-data"><i class="fa fa-check"></i><b>1.7</b> Open data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html"><i class="fa fa-check"></i><b>2</b> Software is everywhere</a>
<ul>
<li class="chapter" data-level="2.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software"><i class="fa fa-check"></i><b>2.1</b> Software</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#command-line-interface-cli"><i class="fa fa-check"></i><b>2.1.1</b> Command line interface (CLI)</a></li>
<li class="chapter" data-level="2.1.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#graphical-user-interface-gui"><i class="fa fa-check"></i><b>2.1.2</b> Graphical user interface (GUI)</a></li>
<li class="chapter" data-level="2.1.3" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#integrated-development-environment-ide"><i class="fa fa-check"></i><b>2.1.3</b> Integrated development environment (IDE)</a></li>
<li class="chapter" data-level="2.1.4" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software-in-your-browser"><i class="fa fa-check"></i><b>2.1.4</b> Software in your browser</a></li>
<li class="chapter" data-level="2.1.5" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#software-in-the-cloud"><i class="fa fa-check"></i><b>2.1.5</b> Software in the cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#file-formats"><i class="fa fa-check"></i><b>2.2</b> File formats</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#text-files"><i class="fa fa-check"></i><b>2.2.1</b> Text files</a></li>
<li class="chapter" data-level="2.2.2" data-path="software-is-everywhere.html"><a href="software-is-everywhere.html#text-with-structure"><i class="fa fa-check"></i><b>2.2.2</b> Text with structure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="group-comparison.html"><a href="group-comparison.html"><i class="fa fa-check"></i><b>3</b> Group Comparison</a>
<ul>
<li class="chapter" data-level="3.1" data-path="group-comparison.html"><a href="group-comparison.html#story-telling"><i class="fa fa-check"></i><b>3.1</b> Story Telling</a></li>
<li class="chapter" data-level="3.2" data-path="group-comparison.html"><a href="group-comparison.html#comparability"><i class="fa fa-check"></i><b>3.2</b> Comparability</a></li>
<li class="chapter" data-level="3.3" data-path="group-comparison.html"><a href="group-comparison.html#never-use-pie-charts"><i class="fa fa-check"></i><b>3.3</b> Never use pie charts</a></li>
<li class="chapter" data-level="3.4" data-path="group-comparison.html"><a href="group-comparison.html#application"><i class="fa fa-check"></i><b>3.4</b> Application</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="group-comparison.html"><a href="group-comparison.html#loading-the-data"><i class="fa fa-check"></i><b>3.4.1</b> Loading the data</a></li>
<li class="chapter" data-level="3.4.2" data-path="group-comparison.html"><a href="group-comparison.html#look-into-data"><i class="fa fa-check"></i><b>3.4.2</b> Look into data</a></li>
<li class="chapter" data-level="3.4.3" data-path="group-comparison.html"><a href="group-comparison.html#fly-over-data"><i class="fa fa-check"></i><b>3.4.3</b> Fly over data</a></li>
<li class="chapter" data-level="3.4.4" data-path="group-comparison.html"><a href="group-comparison.html#missing-data"><i class="fa fa-check"></i><b>3.4.4</b> Missing data</a></li>
<li class="chapter" data-level="3.4.5" data-path="group-comparison.html"><a href="group-comparison.html#explore-data"><i class="fa fa-check"></i><b>3.4.5</b> Explore data</a></li>
<li class="chapter" data-level="3.4.6" data-path="group-comparison.html"><a href="group-comparison.html#standardization"><i class="fa fa-check"></i><b>3.4.6</b> Standardization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mean-comparison.html"><a href="mean-comparison.html"><i class="fa fa-check"></i><b>4</b> Mean Comparison</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mean-comparison.html"><a href="mean-comparison.html#application-1"><i class="fa fa-check"></i><b>4.1</b> Application</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="mean-comparison.html"><a href="mean-comparison.html#data-preparation"><i class="fa fa-check"></i><b>4.1.1</b> Data Preparation</a></li>
<li class="chapter" data-level="4.1.2" data-path="mean-comparison.html"><a href="mean-comparison.html#grouped-mean"><i class="fa fa-check"></i><b>4.1.2</b> Grouped Mean</a></li>
<li class="chapter" data-level="4.1.3" data-path="mean-comparison.html"><a href="mean-comparison.html#furious-with-factors"><i class="fa fa-check"></i><b>4.1.3</b> Furious with Factors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="mean-comparison.html"><a href="mean-comparison.html#students-t-test"><i class="fa fa-check"></i><b>4.2</b> Student’s t-test</a></li>
<li class="chapter" data-level="4.3" data-path="mean-comparison.html"><a href="mean-comparison.html#plot-with-confidence"><i class="fa fa-check"></i><b>4.3</b> Plot with Confidence</a></li>
<li class="chapter" data-level="4.4" data-path="mean-comparison.html"><a href="mean-comparison.html#independent-t-test"><i class="fa fa-check"></i><b>4.4</b> Independent t-test</a></li>
<li class="chapter" data-level="4.5" data-path="mean-comparison.html"><a href="mean-comparison.html#dependent-t-test"><i class="fa fa-check"></i><b>4.5</b> Dependent t-test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="panel-data.html"><a href="panel-data.html#learning-goals"><i class="fa fa-check"></i><b>5.1</b> Learning Goals</a></li>
<li class="chapter" data-level="5.2" data-path="panel-data.html"><a href="panel-data.html#paneldata"><i class="fa fa-check"></i><b>5.2</b> Paneldata</a></li>
<li class="chapter" data-level="5.3" data-path="panel-data.html"><a href="panel-data.html#data-preparation-1"><i class="fa fa-check"></i><b>5.3</b> Data Preparation</a></li>
<li class="chapter" data-level="5.4" data-path="panel-data.html"><a href="panel-data.html#group-by-person"><i class="fa fa-check"></i><b>5.4</b> Group by person</a></li>
<li class="chapter" data-level="5.5" data-path="panel-data.html"><a href="panel-data.html#data-visualization"><i class="fa fa-check"></i><b>5.5</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="panel-data.html"><a href="panel-data.html#average-health-per-year"><i class="fa fa-check"></i><b>5.5.1</b> Average Health per Year</a></li>
<li class="chapter" data-level="5.5.2" data-path="panel-data.html"><a href="panel-data.html#individual-health-per-year"><i class="fa fa-check"></i><b>5.5.2</b> Individual Health per Year</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="panel-data.html"><a href="panel-data.html#within-and-between-variation"><i class="fa fa-check"></i><b>5.6</b> Within and Between Variation</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="panel-data.html"><a href="panel-data.html#xtsum-from-stata"><i class="fa fa-check"></i><b>5.6.1</b> XTSUM (from Stata)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>6</b> Text Mining</a>
<ul>
<li class="chapter" data-level="6.1" data-path="text-mining.html"><a href="text-mining.html#learning-goals-1"><i class="fa fa-check"></i><b>6.1</b> Learning Goals</a></li>
<li class="chapter" data-level="6.2" data-path="text-mining.html"><a href="text-mining.html#get-text"><i class="fa fa-check"></i><b>6.2</b> Get Text</a></li>
<li class="chapter" data-level="6.3" data-path="text-mining.html"><a href="text-mining.html#translate-everything-to-english"><i class="fa fa-check"></i><b>6.3</b> Translate Everything To English</a></li>
<li class="chapter" data-level="6.4" data-path="text-mining.html"><a href="text-mining.html#text-analysis"><i class="fa fa-check"></i><b>6.4</b> Text Analysis</a></li>
<li class="chapter" data-level="6.5" data-path="text-mining.html"><a href="text-mining.html#little-bit-of-scraping"><i class="fa fa-check"></i><b>6.5</b> Little bit of Scraping</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="relationships.html"><a href="relationships.html"><i class="fa fa-check"></i><b>7</b> Relationships</a>
<ul>
<li class="chapter" data-level="7.1" data-path="relationships.html"><a href="relationships.html#minimal-example"><i class="fa fa-check"></i><b>7.1</b> Minimal Example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="relationships.html"><a href="relationships.html#variance"><i class="fa fa-check"></i><b>7.1.1</b> Variance</a></li>
<li class="chapter" data-level="7.1.2" data-path="relationships.html"><a href="relationships.html#variation-around-the-mean"><i class="fa fa-check"></i><b>7.1.2</b> Variation ARound the Mean</a></li>
<li class="chapter" data-level="7.1.3" data-path="relationships.html"><a href="relationships.html#scatterplot"><i class="fa fa-check"></i><b>7.1.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.1.4" data-path="relationships.html"><a href="relationships.html#covariance"><i class="fa fa-check"></i><b>7.1.4</b> Covariance</a></li>
<li class="chapter" data-level="7.1.5" data-path="relationships.html"><a href="relationships.html#covariance-visualization"><i class="fa fa-check"></i><b>7.1.5</b> Covariance Visualization</a></li>
<li class="chapter" data-level="7.1.6" data-path="relationships.html"><a href="relationships.html#correlation"><i class="fa fa-check"></i><b>7.1.6</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="relationships.html"><a href="relationships.html#application-2"><i class="fa fa-check"></i><b>7.2</b> Application</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="relationships.html"><a href="relationships.html#one-variable-graphics"><i class="fa fa-check"></i><b>7.2.1</b> One Variable Graphics</a></li>
<li class="chapter" data-level="7.2.2" data-path="relationships.html"><a href="relationships.html#two-variable-graphics"><i class="fa fa-check"></i><b>7.2.2</b> Two Variable Graphics</a></li>
<li class="chapter" data-level="7.2.3" data-path="relationships.html"><a href="relationships.html#correlation-and-regression"><i class="fa fa-check"></i><b>7.2.3</b> Correlation and Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#from-artists-and-economists"><i class="fa fa-check"></i><b>8.1</b> From Artists and Economists</a></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#data-is-everywhere-1"><i class="fa fa-check"></i><b>8.2</b> Data is everywhere</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="regression.html"><a href="regression.html#data-in-a-table"><i class="fa fa-check"></i><b>8.2.1</b> Data in a table</a></li>
<li class="chapter" data-level="8.2.2" data-path="regression.html"><a href="regression.html#data-in-a-graph"><i class="fa fa-check"></i><b>8.2.2</b> Data in a graph</a></li>
<li class="chapter" data-level="8.2.3" data-path="regression.html"><a href="regression.html#the-trend"><i class="fa fa-check"></i><b>8.2.3</b> The trend</a></li>
<li class="chapter" data-level="8.2.4" data-path="regression.html"><a href="regression.html#the-blackbox"><i class="fa fa-check"></i><b>8.2.4</b> The blackbox</a></li>
<li class="chapter" data-level="8.2.5" data-path="regression.html"><a href="regression.html#nobodys-perfect"><i class="fa fa-check"></i><b>8.2.5</b> Nobody’s perfect</a></li>
<li class="chapter" data-level="8.2.6" data-path="regression.html"><a href="regression.html#vocab-wrap-up"><i class="fa fa-check"></i><b>8.2.6</b> Vocab Wrap-Up</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#for-the-truly-dedicated"><i class="fa fa-check"></i><b>8.3</b> For the truly dedicated</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#algebra"><i class="fa fa-check"></i><b>8.3.1</b> Algebra</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#analysis"><i class="fa fa-check"></i><b>8.3.2</b> Analysis</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#take-the-long-way-home"><i class="fa fa-check"></i><b>8.3.3</b> Take the Long Way Home</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#survival-of-the-fittest-line"><i class="fa fa-check"></i><b>8.4</b> Survival of the Fittest Line</a></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#on-the-shoulders-of-giants"><i class="fa fa-check"></i><b>8.5</b> On the Shoulders of Giants</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>9</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#minimal-example-1"><i class="fa fa-check"></i><b>9.1</b> Minimal Example</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#think-inside-of-a-box"><i class="fa fa-check"></i><b>9.1.1</b> Think inside of a box</a></li>
<li class="chapter" data-level="9.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#from-probability-to-odds"><i class="fa fa-check"></i><b>9.1.2</b> From probability to odds</a></li>
<li class="chapter" data-level="9.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#from-odds-to-log-of-odds"><i class="fa fa-check"></i><b>9.1.3</b> From odds to log of odds</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#application-titanic-survival"><i class="fa fa-check"></i><b>9.2</b> Application: Titanic Survival</a></li>
<li class="chapter" data-level="9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#addons"><i class="fa fa-check"></i><b>9.3</b> Addons</a></li>
<li class="chapter" data-level="9.4" data-path="logistic-regression.html"><a href="logistic-regression.html#motivation"><i class="fa fa-check"></i><b>9.4</b> Motivation</a></li>
<li class="chapter" data-level="9.5" data-path="logistic-regression.html"><a href="logistic-regression.html#load-and-merge"><i class="fa fa-check"></i><b>9.5</b> Load and Merge</a></li>
<li class="chapter" data-level="9.6" data-path="logistic-regression.html"><a href="logistic-regression.html#data-manipulation"><i class="fa fa-check"></i><b>9.6</b> Data Manipulation</a></li>
<li class="chapter" data-level="9.7" data-path="logistic-regression.html"><a href="logistic-regression.html#simple-linear-model"><i class="fa fa-check"></i><b>9.7</b> Simple linear model</a></li>
<li class="chapter" data-level="9.8" data-path="logistic-regression.html"><a href="logistic-regression.html#multiple-regression-with-control"><i class="fa fa-check"></i><b>9.8</b> Multiple regression with control</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="logistic-regression.html"><a href="logistic-regression.html#regression-model"><i class="fa fa-check"></i><b>9.8.1</b> Regression model</a></li>
<li class="chapter" data-level="9.8.2" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-parallel-slopes"><i class="fa fa-check"></i><b>9.8.2</b> Visualization (parallel slopes)</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="logistic-regression.html"><a href="logistic-regression.html#multiple-regression-with-moderator"><i class="fa fa-check"></i><b>9.9</b> Multiple regression with moderator</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-dummy-dummy"><i class="fa fa-check"></i><b>9.9.1</b> Interaction (dummy * dummy)</a></li>
<li class="chapter" data-level="9.9.2" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-categorical-dummy"><i class="fa fa-check"></i><b>9.9.2</b> Interaction (categorical * dummy)</a></li>
<li class="chapter" data-level="9.9.3" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-continuous-dummy"><i class="fa fa-check"></i><b>9.9.3</b> Interaction (continuous * dummy)</a></li>
<li class="chapter" data-level="9.9.4" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-non-parallel-slopes"><i class="fa fa-check"></i><b>9.9.4</b> Visualization (non-parallel slopes)</a></li>
<li class="chapter" data-level="9.9.5" data-path="logistic-regression.html"><a href="logistic-regression.html#interaction-continuous-continuous"><i class="fa fa-check"></i><b>9.9.5</b> Interaction (continuous * continuous)</a></li>
<li class="chapter" data-level="9.9.6" data-path="logistic-regression.html"><a href="logistic-regression.html#visualization-non-parallel-slopes-1"><i class="fa fa-check"></i><b>9.9.6</b> Visualization (non-parallel slopes)</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-1"><i class="fa fa-check"></i><b>9.10</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-at-representatives-task"><i class="fa fa-check"></i><b>9.10.1</b> Marginal effects at representatives (TASK)</a></li>
<li class="chapter" data-level="9.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#marginal-effects-at-the-mean-task"><i class="fa fa-check"></i><b>9.10.2</b> Marginal effects at the mean (TASK)</a></li>
<li class="chapter" data-level="9.10.3" data-path="logistic-regression.html"><a href="logistic-regression.html#average-marginal-effects"><i class="fa fa-check"></i><b>9.10.3</b> Average marginal effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fixed-effects.html"><a href="fixed-effects.html"><i class="fa fa-check"></i><b>10</b> Fixed effects</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fixed-effects.html"><a href="fixed-effects.html#cross-sectional-data-2-pt"><i class="fa fa-check"></i><b>10.1</b> Cross-sectional Data (2 pt)</a></li>
<li class="chapter" data-level="10.2" data-path="fixed-effects.html"><a href="fixed-effects.html#panel-data-2-pt"><i class="fa fa-check"></i><b>10.2</b> Panel Data (2 pt)</a></li>
<li class="chapter" data-level="10.3" data-path="fixed-effects.html"><a href="fixed-effects.html#fixed-effects-regression"><i class="fa fa-check"></i><b>10.3</b> Fixed Effects Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="fixed-effects.html"><a href="fixed-effects.html#first-difference-2-pt"><i class="fa fa-check"></i><b>10.3.1</b> First Difference (2 pt)</a></li>
<li class="chapter" data-level="10.3.2" data-path="fixed-effects.html"><a href="fixed-effects.html#within-estimator-2-pt"><i class="fa fa-check"></i><b>10.3.2</b> Within Estimator (2 pt)</a></li>
<li class="chapter" data-level="10.3.3" data-path="fixed-effects.html"><a href="fixed-effects.html#lsdv-1-pt"><i class="fa fa-check"></i><b>10.3.3</b> LSDV (1 pt)</a></li>
<li class="chapter" data-level="10.3.4" data-path="fixed-effects.html"><a href="fixed-effects.html#comparison-1-pt"><i class="fa fa-check"></i><b>10.3.4</b> Comparison (1 pt)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="first-difference.html"><a href="first-difference.html"><i class="fa fa-check"></i><b>11</b> First Difference</a>
<ul>
<li class="chapter" data-level="11.1" data-path="first-difference.html"><a href="first-difference.html#application-mincer-earnings-function"><i class="fa fa-check"></i><b>11.1</b> Application: Mincer earnings function</a></li>
<li class="chapter" data-level="11.2" data-path="first-difference.html"><a href="first-difference.html#data-management-4-pt"><i class="fa fa-check"></i><b>11.2</b> Data Management (4 pt)</a></li>
<li class="chapter" data-level="11.3" data-path="first-difference.html"><a href="first-difference.html#data-visualization-2-pt"><i class="fa fa-check"></i><b>11.3</b> Data Visualization (2 pt)</a></li>
<li class="chapter" data-level="11.4" data-path="first-difference.html"><a href="first-difference.html#data-modeling-2-pt"><i class="fa fa-check"></i><b>11.4</b> Data Modeling (2 pt)</a></li>
<li class="chapter" data-level="11.5" data-path="first-difference.html"><a href="first-difference.html#minimal-example-2"><i class="fa fa-check"></i><b>11.5</b> Minimal Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://marco-kuehne.com/" target="blank">Visit my personal page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Becoming Fluent in Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = infobox>
This book is <b>Work in Progress</b>. I appreciate your feedback to make the book better.
</div>
<div id="logistic-regression" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Logistic Regression<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Logistic regression is the appropriate regression analysis to conduct when the dependent variable is dichotomous (binary).</p>
<div id="minimal-example-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Minimal Example<a href="logistic-regression.html#minimal-example-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="think-inside-of-a-box" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Think inside of a box<a href="logistic-regression.html#think-inside-of-a-box" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://www.javatpoint.com/linear-regression-vs-logistic-regression-in-machine-learning -->
<p>The following table contains data on the relationship between <em>hours of study</em> and the <em>outcome of an exam</em> (pass/fail) sorted ascending for study hours:</p>
<table class="table" style="font-size: 8px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
pass
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
hours
</td>
<td style="text-align:left;">
0.75
</td>
<td style="text-align:left;">
1.00
</td>
<td style="text-align:left;">
1.50
</td>
<td style="text-align:left;">
1.75
</td>
<td style="text-align:left;">
1.75
</td>
<td style="text-align:left;">
2.00
</td>
<td style="text-align:left;">
2.50
</td>
<td style="text-align:left;">
2.75
</td>
<td style="text-align:left;">
3.00
</td>
<td style="text-align:left;">
3.25
</td>
<td style="text-align:left;">
4.25
</td>
<td style="text-align:left;">
5.00
</td>
</tr>
</tbody>
</table>
<p>Please do a side-by-side plot via <code>ggplot</code> and <code>gridExtra</code> package with <code>pass</code> on the y-axis and <code>hours</code> of study on the x-axis. Please fit a line though the left panel and a squiggle through the right panel. Use the layer <code>geom_smooth</code> with <code>method</code> option either <code>lm</code> (linear model) or <code>glm</code> (general linear model).</p>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-121-1.png" width="576" style="display: block; margin: auto;" /></p>
<!-- The first step is to find the functional form that better describes the data then a linear function.  -->
</div>
<div id="from-probability-to-odds" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> From probability to odds<a href="logistic-regression.html#from-probability-to-odds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/ -->
<!-- https://www.statisticshowto.com/log-odds/ -->
<p>Please do the following:</p>
<ul>
<li>Create a data.frame called <code>data</code>.</li>
<li>Within <code>data</code>, create a sequence of values ranging from 0 to 1 in 0.01 steps and store it as <code>p</code> (probability).</li>
<li>Within <code>data</code>, calculate the corresponding odds, store as <code>odds</code>.</li>
<li>Create a simple plot showing the relation between odds and probability using the <code>plotly</code> package.</li>
</ul>
<!-- Odds and Log Odds: https://www.youtube.com/watch?v=ARfXDSkQf1Y -->
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="logistic-regression.html#cb85-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb85-2"><a href="logistic-regression.html#cb85-2" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb85-3"><a href="logistic-regression.html#cb85-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(p, odds)</span>
<span id="cb85-4"><a href="logistic-regression.html#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="logistic-regression.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="do">## par(mfrow=c(1,2))</span></span>
<span id="cb85-6"><a href="logistic-regression.html#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="do">## plot(p, odds)</span></span>
<span id="cb85-7"><a href="logistic-regression.html#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="do">## plot(p, odds, xlim=c(0,0.25), ylim = c(0,0.25))</span></span>
<span id="cb85-8"><a href="logistic-regression.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="do">## mtext(&quot;My &#39;Title&#39; in a strange place&quot;, side = 3, line = -21, outer = TRUE)</span></span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="logistic-regression.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb86-2"><a href="logistic-regression.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      p       odds</span></span>
<span id="cb86-3"><a href="logistic-regression.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.00 0.00000000</span></span>
<span id="cb86-4"><a href="logistic-regression.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.01 0.01010101</span></span>
<span id="cb86-5"><a href="logistic-regression.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.02 0.02040816</span></span>
<span id="cb86-6"><a href="logistic-regression.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.03 0.03092784</span></span>
<span id="cb86-7"><a href="logistic-regression.html#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.04 0.04166667</span></span>
<span id="cb86-8"><a href="logistic-regression.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0.05 0.05263158</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="logistic-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb87-2"><a href="logistic-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> data, <span class="at">x =</span> <span class="sc">~</span>p, <span class="at">y =</span> <span class="sc">~</span>odds)</span></code></pre></div>
<div id="htmlwidget-44db758151977091446d" style="width:576px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-44db758151977091446d">{"x":{"visdat":{"8fcd9a666f":["function () ","plotlyVisDat"]},"cur_data":"8fcd9a666f","attrs":{"8fcd9a666f":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"p"},"yaxis":{"domain":[0,1],"automargin":true,"title":"odds"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[0,0.0101010101010101,0.0204081632653061,0.0309278350515464,0.0416666666666667,0.0526315789473684,0.0638297872340425,0.0752688172043011,0.0869565217391304,0.0989010989010989,0.111111111111111,0.123595505617978,0.136363636363636,0.149425287356322,0.162790697674419,0.176470588235294,0.19047619047619,0.204819277108434,0.219512195121951,0.234567901234568,0.25,0.265822784810127,0.282051282051282,0.298701298701299,0.315789473684211,0.333333333333333,0.351351351351351,0.36986301369863,0.388888888888889,0.408450704225352,0.428571428571429,0.449275362318841,0.470588235294118,0.492537313432836,0.515151515151515,0.538461538461539,0.5625,0.587301587301587,0.612903225806452,0.639344262295082,0.666666666666667,0.694915254237288,0.724137931034483,0.754385964912281,0.785714285714286,0.818181818181818,0.851851851851852,0.886792452830189,0.923076923076923,0.96078431372549,1,1.04081632653061,1.08333333333333,1.12765957446809,1.17391304347826,1.22222222222222,1.27272727272727,1.32558139534884,1.38095238095238,1.4390243902439,1.5,1.56410256410256,1.63157894736842,1.7027027027027,1.77777777777778,1.85714285714286,1.94117647058824,2.03030303030303,2.125,2.2258064516129,2.33333333333333,2.44827586206897,2.57142857142857,2.7037037037037,2.84615384615385,3,3.16666666666667,3.34782608695652,3.54545454545455,3.76190476190476,4,4.26315789473684,4.55555555555556,4.88235294117647,5.25,5.66666666666667,6.14285714285714,6.69230769230769,7.33333333333333,8.09090909090909,9,10.1111111111111,11.5,13.2857142857143,15.6666666666667,19,24,32.3333333333333,49,98.9999999999999,null],"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="from-odds-to-log-of-odds" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> From odds to log of odds<a href="logistic-regression.html#from-odds-to-log-of-odds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Please calculate the log of odds, store it as <code>logodds</code> (can be another object). Create a side-by-side graph showing the relation between probability and odds and probability and logodds with the <code>plotly</code> package.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="logistic-regression.html#cb88-1" aria-hidden="true" tabindex="-1"></a>logodds <span class="ot">&lt;-</span> <span class="fu">log</span>(odds)</span>
<span id="cb88-2"><a href="logistic-regression.html#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="logistic-regression.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="do">## par(mfrow=c(1,2))</span></span>
<span id="cb88-4"><a href="logistic-regression.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="do">## plot(p, odds)</span></span>
<span id="cb88-5"><a href="logistic-regression.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="do">## plot(p, logodds)</span></span>
<span id="cb88-6"><a href="logistic-regression.html#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="logistic-regression.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb88-8"><a href="logistic-regression.html#cb88-8" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> data, <span class="at">x =</span> <span class="sc">~</span>p, <span class="at">y =</span> <span class="sc">~</span>odds)</span>
<span id="cb88-9"><a href="logistic-regression.html#cb88-9" aria-hidden="true" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> fig1 <span class="sc">%&gt;%</span> <span class="fu">add_lines</span>(<span class="at">name =</span> <span class="sc">~</span><span class="st">&quot;odds&quot;</span>)</span>
<span id="cb88-10"><a href="logistic-regression.html#cb88-10" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> data, <span class="at">x =</span> <span class="sc">~</span>p, <span class="at">y =</span> <span class="sc">~</span>logodds)</span>
<span id="cb88-11"><a href="logistic-regression.html#cb88-11" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> fig2 <span class="sc">%&gt;%</span> <span class="fu">add_lines</span>(<span class="at">name =</span> <span class="sc">~</span><span class="st">&quot;logodds&quot;</span>)</span>
<span id="cb88-12"><a href="logistic-regression.html#cb88-12" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">subplot</span>(fig1, fig2)</span>
<span id="cb88-13"><a href="logistic-regression.html#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="logistic-regression.html#cb88-14" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div>
<div id="htmlwidget-67b62794e33863e62991" style="width:576px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-67b62794e33863e62991">{"x":{"data":[{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[0,0.0101010101010101,0.0204081632653061,0.0309278350515464,0.0416666666666667,0.0526315789473684,0.0638297872340425,0.0752688172043011,0.0869565217391304,0.0989010989010989,0.111111111111111,0.123595505617978,0.136363636363636,0.149425287356322,0.162790697674419,0.176470588235294,0.19047619047619,0.204819277108434,0.219512195121951,0.234567901234568,0.25,0.265822784810127,0.282051282051282,0.298701298701299,0.315789473684211,0.333333333333333,0.351351351351351,0.36986301369863,0.388888888888889,0.408450704225352,0.428571428571429,0.449275362318841,0.470588235294118,0.492537313432836,0.515151515151515,0.538461538461539,0.5625,0.587301587301587,0.612903225806452,0.639344262295082,0.666666666666667,0.694915254237288,0.724137931034483,0.754385964912281,0.785714285714286,0.818181818181818,0.851851851851852,0.886792452830189,0.923076923076923,0.96078431372549,1,1.04081632653061,1.08333333333333,1.12765957446809,1.17391304347826,1.22222222222222,1.27272727272727,1.32558139534884,1.38095238095238,1.4390243902439,1.5,1.56410256410256,1.63157894736842,1.7027027027027,1.77777777777778,1.85714285714286,1.94117647058824,2.03030303030303,2.125,2.2258064516129,2.33333333333333,2.44827586206897,2.57142857142857,2.7037037037037,2.84615384615385,3,3.16666666666667,3.34782608695652,3.54545454545455,3.76190476190476,4,4.26315789473684,4.55555555555556,4.88235294117647,5.25,5.66666666666667,6.14285714285714,6.69230769230769,7.33333333333333,8.09090909090909,9,10.1111111111111,11.5,13.2857142857143,15.6666666666667,19,24,32.3333333333333,49,98.9999999999999,null],"type":"scatter","mode":"lines","name":"odds","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[null,-4.59511985013459,-3.89182029811063,-3.47609868983527,-3.17805383034795,-2.94443897916644,-2.75153531304195,-2.58668934409794,-2.4423470353692,-2.31363492918063,-2.19722457733622,-2.09074109693377,-1.99243016469021,-1.90095876119305,-1.81528996663825,-1.73460105538811,-1.65822807660353,-1.58562726374038,-1.51634748936809,-1.450010175506,-1.38629436111989,-1.3249254147436,-1.26566637333128,-1.20831120592453,-1.15267950993839,-1.09861228866811,-1.04596855518269,-0.994622575144062,-0.944461608840851,-0.895384047054841,-0.847297860387204,-0.800119300112113,-0.75377180237638,-0.708185057924486,-0.663294217410264,-0.619039208406223,-0.575364144903562,-0.532216813747308,-0.489548225318706,-0.447312218043665,-0.405465108108164,-0.363965377201412,-0.322773392263051,-0.281851152140988,-0.241162056816888,-0.200670695462151,-0.160342650075179,-0.120144311842063,-0.0800427076735365,-0.0400053346136992,0,0.0400053346136992,0.0800427076735366,0.120144311842063,0.160342650075179,0.200670695462151,0.241162056816888,0.281851152140988,0.322773392263051,0.363965377201411,0.405465108108164,0.447312218043665,0.489548225318706,0.532216813747308,0.575364144903562,0.619039208406224,0.663294217410264,0.708185057924486,0.75377180237638,0.800119300112113,0.847297860387204,0.895384047054841,0.944461608840851,0.994622575144062,1.04596855518269,1.09861228866811,1.15267950993839,1.20831120592453,1.26566637333128,1.3249254147436,1.38629436111989,1.450010175506,1.51634748936809,1.58562726374038,1.65822807660353,1.73460105538811,1.81528996663825,1.90095876119305,1.99243016469021,2.09074109693377,2.19722457733622,2.31363492918063,2.44234703536921,2.58668934409794,2.75153531304195,2.94443897916644,3.17805383034794,3.47609868983527,3.89182029811063,4.59511985013459,null],"type":"scatter","mode":"lines","name":"logodds","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.48],"automargin":true,"anchor":"y"},"xaxis2":{"domain":[0.52,1],"automargin":true,"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true},"attrs":{"8fc3e90597e":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","name":{},"inherit":true},"8fc72b84bcb":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","name":{},"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Imagine you flip the axes, doesn’t this look like the initial S curve we were looking for?
<!-- https://www.graphpad.com/guides/prism/latest/curve-fitting/reg_simple_logistic_logodds.htm -->
<!-- https://www.graphpad.com/guides/prism/latest/curve-fitting/reg_log_or_ln.htm -->
<!-- https://www.graphpad.com/guides/prism/latest/curve-fitting/reg_simple_logistic_coefficients.htm -->
<!-- http://faculty.cas.usf.edu/mbrannick/regression/Logistic.html -->
<!-- Logistic regression estimation is based on the concept of Maximum Likelihood estimation.  --></p>
</div>
</div>
<div id="application-titanic-survival" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Application: Titanic Survival<a href="logistic-regression.html#application-titanic-survival" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-management-2-pt" class="section level4 hasAnchor" number="9.2.0.1">
<h4><span class="header-section-number">9.2.0.1</span> Data Management (2 pt)<a href="logistic-regression.html#data-management-2-pt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Please register at Kaggle. Go to <a href="https://www.kaggle.com/c/titanic/data" class="uri">https://www.kaggle.com/c/titanic/data</a> and download the datasets (<code>train.csv</code>, <code>test.csv</code>, <code>gender_submission.csv</code>). Put them in your working directory. The following merge commands should work.</p>
<!-- Let's merge the datasets and create a dataframe called `titanic`.  -->
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="logistic-regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-2"><a href="logistic-regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="logistic-regression.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="do">## load individual datasets</span></span>
<span id="cb89-4"><a href="logistic-regression.html#cb89-4" aria-hidden="true" tabindex="-1"></a>titanic.train <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/train.csv&#39;</span>,  <span class="at">header =</span> T, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&#39;&#39;</span>))</span>
<span id="cb89-5"><a href="logistic-regression.html#cb89-5" aria-hidden="true" tabindex="-1"></a>titanic.test <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/test.csv&#39;</span>, <span class="at">header =</span> T, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>))</span>
<span id="cb89-6"><a href="logistic-regression.html#cb89-6" aria-hidden="true" tabindex="-1"></a>test.label <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/gender_submission.csv&#39;</span>, <span class="at">header =</span> T, <span class="at">na.string=</span><span class="fu">c</span>(<span class="st">&quot;&quot;</span>))</span>
<span id="cb89-7"><a href="logistic-regression.html#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="do">## merge labels with test</span></span>
<span id="cb89-8"><a href="logistic-regression.html#cb89-8" aria-hidden="true" tabindex="-1"></a>titanic.test <span class="ot">=</span> <span class="fu">merge</span>(titanic.test, test.label, <span class="at">by =</span> <span class="st">&quot;PassengerId&quot;</span>)</span>
<span id="cb89-9"><a href="logistic-regression.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="do">## bind test and train (here we don&#39;t make the distinction)</span></span>
<span id="cb89-10"><a href="logistic-regression.html#cb89-10" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">=</span> <span class="fu">rbind</span>(titanic.test, titanic.train)</span>
<span id="cb89-11"><a href="logistic-regression.html#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="do">## convert Pclass to factor (from numeric)</span></span>
<span id="cb89-12"><a href="logistic-regression.html#cb89-12" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>Pclass <span class="ot">=</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>Pclass)</span>
<span id="cb89-13"><a href="logistic-regression.html#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="do">## convert all character variables to factor</span></span>
<span id="cb89-14"><a href="logistic-regression.html#cb89-14" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(titanic, <span class="at">stringsAsFactors=</span><span class="cn">TRUE</span>)</span>
<span id="cb89-15"><a href="logistic-regression.html#cb89-15" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character,as.factor)</span></code></pre></div>
<p>Let’s check the number of missing values per variable:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="logistic-regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## missings per variable n = 1309</span></span>
<span id="cb90-2"><a href="logistic-regression.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="at">X =</span> titanic, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb90-3"><a href="logistic-regression.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PassengerId      Pclass        Name         Sex         Age       SibSp </span></span>
<span id="cb90-4"><a href="logistic-regression.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           0           0           0           0         263           0 </span></span>
<span id="cb90-5"><a href="logistic-regression.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Parch      Ticket        Fare       Cabin    Embarked    Survived </span></span>
<span id="cb90-6"><a href="logistic-regression.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           0           0           1        1014           2           0</span></span></code></pre></div>
<p>There are 2 missing values in <code>Embarked</code> and 263 in <code>Age</code>. The most missings fall upon <code>Cabin</code> though. Cabin information is not a very useful predictor for survival, thus we can remove this information for our analysis.</p>
<!-- Remove columns `PassengerId`, `Name` and `Ticket`. -->
<p>Conduct a <em>complete case analysis</em>. The dataset should look like this (n = 1043):</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="logistic-regression.html#cb91-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>Cabin)</span>
<span id="cb91-2"><a href="logistic-regression.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="logistic-regression.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ## n = 1043</span></span>
<span id="cb91-4"><a href="logistic-regression.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="do">## titanic &lt;- titanic %&gt;%</span></span>
<span id="cb91-5"><a href="logistic-regression.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   filter(Age &gt; 0)</span></span>
<span id="cb91-6"><a href="logistic-regression.html#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="logistic-regression.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="do">## complete cases n = 1043</span></span>
<span id="cb91-8"><a href="logistic-regression.html#cb91-8" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic[<span class="fu">complete.cases</span>(titanic), ]</span>
<span id="cb91-9"><a href="logistic-regression.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(titanic)</span>
<span id="cb91-10"><a href="logistic-regression.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 1,043</span></span>
<span id="cb91-11"><a href="logistic-regression.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 11</span></span>
<span id="cb91-12"><a href="logistic-regression.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ PassengerId &lt;int&gt; 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 903, 904…</span></span>
<span id="cb91-13"><a href="logistic-regression.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Pclass      &lt;fct&gt; 3, 3, 2, 3, 3, 3, 3, 2, 3, 3, 1, 1, 2, 1, 2, 2, 3, 3, 3, 1…</span></span>
<span id="cb91-14"><a href="logistic-regression.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Name        &lt;fct&gt; &quot;Kelly, Mr. James&quot;, &quot;Wilkes, Mrs. James (Ellen Needs)&quot;, &quot;M…</span></span>
<span id="cb91-15"><a href="logistic-regression.html#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Sex         &lt;fct&gt; male, female, male, male, female, male, female, male, fema…</span></span>
<span id="cb91-16"><a href="logistic-regression.html#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Age         &lt;dbl&gt; 34.5, 47.0, 62.0, 27.0, 22.0, 14.0, 30.0, 26.0, 18.0, 21.0…</span></span>
<span id="cb91-17"><a href="logistic-regression.html#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ SibSp       &lt;int&gt; 0, 1, 0, 0, 1, 0, 0, 1, 0, 2, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1…</span></span>
<span id="cb91-18"><a href="logistic-regression.html#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Parch       &lt;int&gt; 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span id="cb91-19"><a href="logistic-regression.html#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Ticket      &lt;fct&gt; 330911, 363272, 240276, 315154, 3101298, 7538, 330972, 248…</span></span>
<span id="cb91-20"><a href="logistic-regression.html#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Fare        &lt;dbl&gt; 7.8292, 7.0000, 9.6875, 8.6625, 12.2875, 9.2250, 7.6292, 2…</span></span>
<span id="cb91-21"><a href="logistic-regression.html#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Embarked    &lt;fct&gt; Q, S, Q, S, S, S, Q, S, C, S, S, S, S, S, C, Q, C, S, C, C…</span></span>
<span id="cb91-22"><a href="logistic-regression.html#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ Survived    &lt;int&gt; 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0…</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="logistic-regression.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## estimation</span></span>
<span id="cb92-2"><a href="logistic-regression.html#cb92-2" aria-hidden="true" tabindex="-1"></a>titanic_estimation <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(PassengerId, Name, Ticket))</span></code></pre></div>
</div>
<div id="no-predictor-variables-1-pt" class="section level4 hasAnchor" number="9.2.0.2">
<h4><span class="header-section-number">9.2.0.2</span> No Predictor Variables (1 pt)<a href="logistic-regression.html#no-predictor-variables-1-pt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is no predictor, only the intercept (empty model):</p>
<p><span class="math display">\[logit (p) = \beta_0\]</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="logistic-regression.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb93-2"><a href="logistic-regression.html#cb93-2" aria-hidden="true" tabindex="-1"></a>logistic0 <span class="ot">=</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> titanic)</span>
<span id="cb93-3"><a href="logistic-regression.html#cb93-3" aria-hidden="true" tabindex="-1"></a>logistic0</span>
<span id="cb93-4"><a href="logistic-regression.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-5"><a href="logistic-regression.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = Survived ~ 1, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb93-6"><a href="logistic-regression.html#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = titanic)</span></span>
<span id="cb93-7"><a href="logistic-regression.html#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-8"><a href="logistic-regression.html#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb93-9"><a href="logistic-regression.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  </span></span>
<span id="cb93-10"><a href="logistic-regression.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -0.4143  </span></span>
<span id="cb93-11"><a href="logistic-regression.html#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb93-12"><a href="logistic-regression.html#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1042 Total (i.e. Null);  1042 Residual</span></span>
<span id="cb93-13"><a href="logistic-regression.html#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1402 </span></span>
<span id="cb93-14"><a href="logistic-regression.html#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 1402  AIC: 1404</span></span></code></pre></div>
<!-- In all logistic regression models regression coefficients are reported in log odds.  -->
<!-- This means \( log (1/(1-p)) = \) -0.41.  -->
<p>Please recalculate the intercept from model <code>logistic0</code>, i.e. the value -0.4142616.</p>
<p>Use the probability of survival from <code>titanic</code> data (check the count of <code>titanic$Survived</code>). Store and show the probability of survival in a vector named <code>survive_p</code>. Store and show the odds of survival as <code>survive_odds</code>. Calculate and store the logodds of survival as <code>survive_logodds</code> (this should be equivalent to the empty model intercept).</p>
<!-- From probability, calculate odds and logodds (this should be equivalent to the empty model intercept).  -->
<!-- Let's take a look at the frequency table for survival and derive this value step by step: -->
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="logistic-regression.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">##table(titanic$Survived)</span></span>
<span id="cb94-2"><a href="logistic-regression.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="do">##table(titanic$Survived)[1]</span></span>
<span id="cb94-3"><a href="logistic-regression.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="do">##table(titanic$Survived)[2]</span></span>
<span id="cb94-4"><a href="logistic-regression.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="logistic-regression.html#cb94-5" aria-hidden="true" tabindex="-1"></a>survive_p <span class="ot">&lt;-</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived)[<span class="dv">2</span>]<span class="sc">/</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived)[<span class="dv">2</span>]<span class="sc">+</span><span class="fu">table</span>(titanic<span class="sc">$</span>Survived)[<span class="dv">1</span>]) </span>
<span id="cb94-6"><a href="logistic-regression.html#cb94-6" aria-hidden="true" tabindex="-1"></a>survive_odds <span class="ot">&lt;-</span> survive_p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>survive_p)</span>
<span id="cb94-7"><a href="logistic-regression.html#cb94-7" aria-hidden="true" tabindex="-1"></a>survive_logodds <span class="ot">&lt;-</span> <span class="fu">log</span>(survive_odds)</span>
<span id="cb94-8"><a href="logistic-regression.html#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="logistic-regression.html#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ## 38.9% survived</span></span>
<span id="cb94-10"><a href="logistic-regression.html#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 398/(398+623)</span></span>
<span id="cb94-11"><a href="logistic-regression.html#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ## The odds are</span></span>
<span id="cb94-12"><a href="logistic-regression.html#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.3898139/ (1-0.3898139)</span></span>
<span id="cb94-13"><a href="logistic-regression.html#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ## 0.6229509 and the log of the odds (logit) is</span></span>
<span id="cb94-14"><a href="logistic-regression.html#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="do">## log(0.6388443)</span></span>
<span id="cb94-15"><a href="logistic-regression.html#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ## -0.4480945, exactly what the regression intercept is</span></span></code></pre></div>
</div>
<div id="single-dichotomous-predictor-1-pt" class="section level4 hasAnchor" number="9.2.0.3">
<h4><span class="header-section-number">9.2.0.3</span> Single Dichotomous Predictor (1 pt)<a href="logistic-regression.html#single-dichotomous-predictor-1-pt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now include gender as an explanatory variable. We expect being male reduces the probability of surviving.</p>
<p><span class="math display">\[logit (p) = \beta_0 + \beta_1 \cdot sex\]</span></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="logistic-regression.html#cb95-1" aria-hidden="true" tabindex="-1"></a>logistic1 <span class="ot">=</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> Sex, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> titanic)</span>
<span id="cb95-2"><a href="logistic-regression.html#cb95-2" aria-hidden="true" tabindex="-1"></a>logistic1</span>
<span id="cb95-3"><a href="logistic-regression.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-4"><a href="logistic-regression.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = Survived ~ Sex, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb95-5"><a href="logistic-regression.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = titanic)</span></span>
<span id="cb95-6"><a href="logistic-regression.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-7"><a href="logistic-regression.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb95-8"><a href="logistic-regression.html#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      Sexmale  </span></span>
<span id="cb95-9"><a href="logistic-regression.html#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       1.616       -3.418  </span></span>
<span id="cb95-10"><a href="logistic-regression.html#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb95-11"><a href="logistic-regression.html#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1042 Total (i.e. Null);  1041 Residual</span></span>
<span id="cb95-12"><a href="logistic-regression.html#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1402 </span></span>
<span id="cb95-13"><a href="logistic-regression.html#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 882.6     AIC: 886.6</span></span></code></pre></div>
<p>The dummy variable behaves as in the linear model:</p>
<ul>
<li>The logodds of survival for men are: -1.8024548</li>
<li>The logodds of survival for women are: 1.6156685</li>
</ul>
<p>Please calculate the logodds for men based on the frequencies of male and female survival:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="logistic-regression.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)</span>
<span id="cb96-2"><a href="logistic-regression.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    </span></span>
<span id="cb96-3"><a href="logistic-regression.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     female male</span></span>
<span id="cb96-4"><a href="logistic-regression.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0     64  564</span></span>
<span id="cb96-5"><a href="logistic-regression.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1    322   93</span></span></code></pre></div>
<p>Please use a programmatic approach in R to access those values. All calculations and results need to be shown.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="logistic-regression.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## odds ratio: odds for female to the odds for male: 2.876543/0.2329059 = 12.35067 == (233*468)/(81*109)</span></span>
<span id="cb97-2"><a href="logistic-regression.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="do">## the odds for females are about 1235% higher than the odds for males</span></span>
<span id="cb97-3"><a href="logistic-regression.html#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="logistic-regression.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="do">## odds ratio: odds for male to the odds for female: 0.2329059/2.876543 = 0.08096729</span></span>
<span id="cb97-5"><a href="logistic-regression.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="do">## the odds for male are about 8% of the odds for females</span></span>
<span id="cb97-6"><a href="logistic-regression.html#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="logistic-regression.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The coefficient for female is the log of odds ratio between the female group and male group: log(12.35067) = 2.51371</span></span>
<span id="cb97-8"><a href="logistic-regression.html#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="do">## The coefficient for male is the log of odds ratio between the male group and female group: log(0.08096729) = -2.51371</span></span>
<span id="cb97-9"><a href="logistic-regression.html#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="logistic-regression.html#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="do">###### titanic full data</span></span>
<span id="cb97-11"><a href="logistic-regression.html#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)</span>
<span id="cb97-12"><a href="logistic-regression.html#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="logistic-regression.html#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="do">## male survival: (~ 14%)</span></span>
<span id="cb97-14"><a href="logistic-regression.html#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb97-15"><a href="logistic-regression.html#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="logistic-regression.html#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ## female survival: (~ 83%)</span></span>
<span id="cb97-17"><a href="logistic-regression.html#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb97-18"><a href="logistic-regression.html#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="logistic-regression.html#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="do">## male odds:</span></span>
<span id="cb97-20"><a href="logistic-regression.html#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb97-21"><a href="logistic-regression.html#cb97-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-22"><a href="logistic-regression.html#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="do">## female odds:</span></span>
<span id="cb97-23"><a href="logistic-regression.html#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb97-24"><a href="logistic-regression.html#cb97-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-25"><a href="logistic-regression.html#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="do">## logodds male</span></span>
<span id="cb97-26"><a href="logistic-regression.html#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb97-27"><a href="logistic-regression.html#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="do">## logodds female</span></span>
<span id="cb97-28"><a href="logistic-regression.html#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb97-29"><a href="logistic-regression.html#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="logistic-regression.html#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="do">## odds ratio: odds for male to the odds for female: 0.03277389</span></span>
<span id="cb97-31"><a href="logistic-regression.html#cb97-31" aria-hidden="true" tabindex="-1"></a>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb97-32"><a href="logistic-regression.html#cb97-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-33"><a href="logistic-regression.html#cb97-33" aria-hidden="true" tabindex="-1"></a><span class="do">## odds ratio: odds for female to the odds for male: 30.5121</span></span>
<span id="cb97-34"><a href="logistic-regression.html#cb97-34" aria-hidden="true" tabindex="-1"></a>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>])<span class="sc">/</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>])</span></code></pre></div>
<!-- The coefficient for male is the log of odds ratio between the male group and female group: -3.465955 -->
<!--  log(0.03124315) -->
<!-- https://data.library.virginia.edu/visualizing-the-effects-of-logistic-regression/ -->
</div>
<div id="effect-plot-1-pt" class="section level4 hasAnchor" number="9.2.0.4">
<h4><span class="header-section-number">9.2.0.4</span> Effect plot (1 pt)<a href="logistic-regression.html#effect-plot-1-pt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Use a nested version of <code>plot()</code> on <code>allEffects()</code> on the <code>logistic1</code> model (<code>effects</code> package).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="logistic-regression.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb98-2"><a href="logistic-regression.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(logistic1))</span></code></pre></div>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-135-1.png" width="576" /></p>
<p>What kind of effect does this plot show? And how did the effects package make those estimates? Inverse the logit function on the logodds estimates. Define the function <code>invLogit()</code>:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="logistic-regression.html#cb99-1" aria-hidden="true" tabindex="-1"></a>invLogit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x))</span></code></pre></div>
<p>Apply <code>invLogit()</code> on the logodds for males. Show that the results are equivalent to the numbers from the effect plot.</p>
<!-- the results of the allEffects() function to an object and investigating. When we do it for this model we get a list object with two elements, one for each graph. Within each list element are several values used to create the effect plots. The model.matrix element for the first list element contains the independent variables used in generating the predictions for each sex. -->
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="logistic-regression.html#cb100-1" aria-hidden="true" tabindex="-1"></a>invLogit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x))</span>
<span id="cb100-2"><a href="logistic-regression.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="logistic-regression.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">## logodds male</span></span>
<span id="cb100-4"><a href="logistic-regression.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">invLogit</span>(<span class="fu">log</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">2</span>]))</span>
<span id="cb100-5"><a href="logistic-regression.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="do">## logodds female</span></span>
<span id="cb100-6"><a href="logistic-regression.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">invLogit</span>(<span class="fu">log</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)[<span class="dv">1</span>,<span class="dv">1</span>]))</span></code></pre></div>
<!-- ##https://stats.stackexchange.com/questions/181996/logistic-regression-interpretation -->
<!-- ## First off, you need to understand that, because the "regression function" is S-shaped, -->
<!-- ## the first derivative is not constant. You therefore need to calculate the marginal effect at a certain point. -->
<!-- ## Comparatively, in a linear regression, we do not have to care about that since the slope of a line -->
<!-- ## is the same everywhere on this line. You have different possibilities: calculate the marginal effect at the mean -->
<!-- ## (in general the default option), at the median, or at particular data points. -->
<!-- ##https://www.displayr.com/how-to-interpret-logistic-regression-coefficients/ -->
<!-- ## In some areas it is common to use odds rather than probabilities when thinking about risk -->
<!-- ## (e.g., gambling, medical statistics). If you are working in one of these areas, -->
<!-- ## it is often necessary to interpret and present coefficients as odds ratios. If you are -->
<!-- ## not in one of these areas, there is no need to read the rest of this post, as the -->
<!-- ## concept of odds ratios is of sociological rather than logical importance (i.e., using -->
<!-- ## odds ratios is not particularly useful except when communicating with people that require them). -->
</div>
<div id="chi-square-test-for-independence-1-pt" class="section level4 hasAnchor" number="9.2.0.5">
<h4><span class="header-section-number">9.2.0.5</span> Chi Square Test For Independence (1 pt)<a href="logistic-regression.html#chi-square-test-for-independence-1-pt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>epitab</code> package can improve the contingency tables of survival by gender. From looking at this table, a lot men died (n = 564) and a lot women survived (n = 322). Those who survied have been about 77% female, those who deceased are about 90% male.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="logistic-regression.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epitab)</span>
<span id="cb101-2"><a href="logistic-regression.html#cb101-2" aria-hidden="true" tabindex="-1"></a>titanic_fct <span class="ot">&lt;-</span> titanic <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="logistic-regression.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Survived_fct =</span> <span class="fu">factor</span>(Survived))</span>
<span id="cb101-4"><a href="logistic-regression.html#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="logistic-regression.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="do">## levels = c(&quot;Deceased&quot;, &quot;Survived&quot;)</span></span>
<span id="cb101-6"><a href="logistic-regression.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="do">## levels(titanic_fct$Survived_fct) </span></span>
<span id="cb101-7"><a href="logistic-regression.html#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="logistic-regression.html#cb101-8" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">contingency_table</span>(<span class="fu">list</span>(<span class="st">&quot;Sex&quot;</span><span class="ot">=</span><span class="st">&#39;Sex&#39;</span>),</span>
<span id="cb101-9"><a href="logistic-regression.html#cb101-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">outcomes=</span><span class="fu">list</span>(<span class="st">&#39;Survival&#39;</span><span class="ot">=</span><span class="st">&#39;Survived_fct&#39;</span>), <span class="do">## need to be factors</span></span>
<span id="cb101-10"><a href="logistic-regression.html#cb101-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crosstab_funcs=</span><span class="fu">list</span>(<span class="fu">freq</span>()),</span>
<span id="cb101-11"><a href="logistic-regression.html#cb101-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data=</span>titanic_fct)</span>
<span id="cb101-12"><a href="logistic-regression.html#cb101-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb101-13"><a href="logistic-regression.html#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="fu">neat_table</span>(tab, <span class="at">format =</span> <span class="fu">c</span>(<span class="st">&quot;html&quot;</span>))</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Survival
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
All
</th>
<th style="text-align:left;">
0
</th>
<th style="text-align:left;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
1043
</td>
<td style="text-align:left;">
628 (100)
</td>
<td style="text-align:left;">
415 (100)
</td>
</tr>
<tr grouplength="2">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Sex</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
female
</td>
<td style="text-align:left;">
386 (37)
</td>
<td style="text-align:left;">
64 (10.2)
</td>
<td style="text-align:left;">
322 (77.6)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
male
</td>
<td style="text-align:left;">
657 (63)
</td>
<td style="text-align:left;">
564 (89.8)
</td>
<td style="text-align:left;">
93 (22.4)
</td>
</tr>
</tbody>
</table>
<p>The <span class="math inline">\(\chi^2\)</span> test is an alternative to test the relationship between two categorical variables.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="logistic-regression.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)</span>
<span id="cb102-2"><a href="logistic-regression.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-3"><a href="logistic-regression.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction</span></span>
<span id="cb102-4"><a href="logistic-regression.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb102-5"><a href="logistic-regression.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  titanic$Survived and titanic$Sex</span></span>
<span id="cb102-6"><a href="logistic-regression.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 484.02, df = 1, p-value &lt; 2.2e-16</span></span></code></pre></div>
<p>Please recalculate the test statistic, i.e. the value:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="logistic-regression.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)<span class="sc">$</span>statistic</span>
<span id="cb103-2"><a href="logistic-regression.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared </span></span>
<span id="cb103-3"><a href="logistic-regression.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  484.0245</span></span></code></pre></div>
<p>from the observed values. The formula for <span class="math inline">\(X^2\)</span> is:
<!-- , calculate row and column sums and from here the expected absolute frequency per cell. --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="logistic-regression.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex))</span></code></pre></div>
<p><span class="math inline">\(X^2 = \sum_i \frac{(O_i-E_i)^2}{E_i}\)</span>,</p>
<p>where <span class="math inline">\(O_i\)</span> is the observed frequency and <span class="math inline">\(E_i\)</span> is the expected frequency. The following steps are suggested.</p>
<!-- Luckily, there is a package and a function to simplify this step.  -->
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="logistic-regression.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 1: Store the observed values in a table</span></span>
<span id="cb105-2"><a href="logistic-regression.html#cb105-2" aria-hidden="true" tabindex="-1"></a>tab_obs <span class="ot">&lt;-</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)</span>
<span id="cb105-3"><a href="logistic-regression.html#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="logistic-regression.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 2: Calculate expected absolute frequency</span></span>
<span id="cb105-5"><a href="logistic-regression.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DescTools&quot;</span>)</span>
<span id="cb105-6"><a href="logistic-regression.html#cb105-6" aria-hidden="true" tabindex="-1"></a>tab_exp <span class="ot">&lt;-</span> <span class="fu">ExpFreq</span>(XYZ, <span class="at">freq =</span><span class="st">&quot;abs&quot;</span>)</span>
<span id="cb105-7"><a href="logistic-regression.html#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="logistic-regression.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 3: Subtract the expected value from the observed value (and square differences)</span></span>
<span id="cb105-9"><a href="logistic-regression.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ...</span></span>
<span id="cb105-10"><a href="logistic-regression.html#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="logistic-regression.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 4: Divide by expected values</span></span>
<span id="cb105-12"><a href="logistic-regression.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ... </span></span>
<span id="cb105-13"><a href="logistic-regression.html#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="logistic-regression.html#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 5: Sum up all</span></span>
<span id="cb105-15"><a href="logistic-regression.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ... </span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="logistic-regression.html#cb106-1" aria-hidden="true" tabindex="-1"></a>tab_margins <span class="ot">&lt;-</span> <span class="fu">addmargins</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex))</span>
<span id="cb106-2"><a href="logistic-regression.html#cb106-2" aria-hidden="true" tabindex="-1"></a>tab_obs <span class="ot">&lt;-</span> <span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex)</span>
<span id="cb106-3"><a href="logistic-regression.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="logistic-regression.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 1: Expected absolute frequency</span></span>
<span id="cb106-5"><a href="logistic-regression.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DescTools&quot;</span>)</span>
<span id="cb106-6"><a href="logistic-regression.html#cb106-6" aria-hidden="true" tabindex="-1"></a>tab_exp <span class="ot">&lt;-</span> <span class="fu">ExpFreq</span>(<span class="fu">table</span>(titanic<span class="sc">$</span>Survived, titanic<span class="sc">$</span>Sex), <span class="at">freq =</span><span class="st">&quot;abs&quot;</span>)</span>
<span id="cb106-7"><a href="logistic-regression.html#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="logistic-regression.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 2: Subtract the expected value from the observed value (and square differences)</span></span>
<span id="cb106-9"><a href="logistic-regression.html#cb106-9" aria-hidden="true" tabindex="-1"></a>(tab_obs<span class="sc">-</span>tab_exp)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb106-10"><a href="logistic-regression.html#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="logistic-regression.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 3: Divide by expected values</span></span>
<span id="cb106-12"><a href="logistic-regression.html#cb106-12" aria-hidden="true" tabindex="-1"></a>(tab_obs<span class="sc">-</span>tab_exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>tab_exp</span>
<span id="cb106-13"><a href="logistic-regression.html#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="logistic-regression.html#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 4: Sum up all</span></span>
<span id="cb106-15"><a href="logistic-regression.html#cb106-15" aria-hidden="true" tabindex="-1"></a>tab_temp <span class="ot">&lt;-</span> (tab_obs<span class="sc">-</span>tab_exp)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>tab_exp</span>
<span id="cb106-16"><a href="logistic-regression.html#cb106-16" aria-hidden="true" tabindex="-1"></a>tab_temp[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> tab_temp[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> tab_temp[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> tab_temp[<span class="dv">2</span>,<span class="dv">2</span>]</span></code></pre></div>
</div>
</div>
<div id="addons" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Addons<a href="logistic-regression.html#addons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="some-are-more-equal-than-others" class="section level4 hasAnchor" number="9.3.0.1">
<h4><span class="header-section-number">9.3.0.1</span> Some Are More Equal Than Others<a href="logistic-regression.html#some-are-more-equal-than-others" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s extend the group analysis to multiple categories using the <code>Pclass</code> variable. The passenger class represents the socio-economic status of people. We hypothesize that people with more money used their influence to get into one of the lifeboats. First, the contingency table of the situation:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="logistic-regression.html#cb107-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">contingency_table</span>(<span class="fu">list</span>(<span class="st">&quot;Passenger Class&quot;</span><span class="ot">=</span><span class="st">&#39;Pclass&#39;</span>),</span>
<span id="cb107-2"><a href="logistic-regression.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">outcomes=</span><span class="fu">list</span>(<span class="st">&#39;Survival&#39;</span><span class="ot">=</span><span class="st">&#39;Survived_fct&#39;</span>), <span class="do">## need to be factors</span></span>
<span id="cb107-3"><a href="logistic-regression.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crosstab_funcs=</span><span class="fu">list</span>(<span class="fu">freq</span>()),</span>
<span id="cb107-4"><a href="logistic-regression.html#cb107-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data=</span>titanic_fct)</span>
<span id="cb107-5"><a href="logistic-regression.html#cb107-5" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb107-6"><a href="logistic-regression.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">neat_table</span>(tab, <span class="at">format =</span> <span class="fu">c</span>(<span class="st">&quot;html&quot;</span>))</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Survival
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
All
</th>
<th style="text-align:left;">
0
</th>
<th style="text-align:left;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:left;">
1043
</td>
<td style="text-align:left;">
628 (100)
</td>
<td style="text-align:left;">
415 (100)
</td>
</tr>
<tr grouplength="3">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Passenger Class</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
1
</td>
<td style="text-align:left;">
282 (27)
</td>
<td style="text-align:left;">
114 (18.2)
</td>
<td style="text-align:left;">
168 (40.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2
</td>
<td style="text-align:left;">
261 (25)
</td>
<td style="text-align:left;">
149 (23.7)
</td>
<td style="text-align:left;">
112 (27)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
3
</td>
<td style="text-align:left;">
500 (47.9)
</td>
<td style="text-align:left;">
365 (58.1)
</td>
<td style="text-align:left;">
135 (32.5)
</td>
</tr>
</tbody>
</table>
<p>In first class, more people survived (n=168) than died (n=114) whereas this not true for the third class (365 died and 135 survived). All men may be created equal, but some are more equal than others. The logistic regression with one categorical variable is straightforward:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="logistic-regression.html#cb108-1" aria-hidden="true" tabindex="-1"></a>logistic2 <span class="ot">=</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> Pclass, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> titanic)</span>
<span id="cb108-2"><a href="logistic-regression.html#cb108-2" aria-hidden="true" tabindex="-1"></a>logistic2</span>
<span id="cb108-3"><a href="logistic-regression.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb108-4"><a href="logistic-regression.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = Survived ~ Pclass, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb108-5"><a href="logistic-regression.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = titanic)</span></span>
<span id="cb108-6"><a href="logistic-regression.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb108-7"><a href="logistic-regression.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb108-8"><a href="logistic-regression.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      Pclass2      Pclass3  </span></span>
<span id="cb108-9"><a href="logistic-regression.html#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.3878      -0.6732      -1.3824  </span></span>
<span id="cb108-10"><a href="logistic-regression.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb108-11"><a href="logistic-regression.html#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1042 Total (i.e. Null);  1040 Residual</span></span>
<span id="cb108-12"><a href="logistic-regression.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1402 </span></span>
<span id="cb108-13"><a href="logistic-regression.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 1320  AIC: 1326</span></span></code></pre></div>
<p>The lower your socio-economic status, the less survival can you expect.</p>
</div>
<div id="the-cheaper-the-deader" class="section level4 hasAnchor" number="9.3.0.2">
<h4><span class="header-section-number">9.3.0.2</span> The Cheaper The Deader?<a href="logistic-regression.html#the-cheaper-the-deader" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have another option to investigate the effect of socio-economic class, the <code>Fare</code> variable (ticket price). The prices of tickets on the Titanic in 1912 ranged from £870 or $4,350 for a first-class parlor suite to a maximum of £8 or $40 for a third-class passage, according to The Washington Times. A century later, in 2012, those ticket prices equaled a range of $50,000 to $460.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="logistic-regression.html#cb109-1" aria-hidden="true" tabindex="-1"></a>logistic3 <span class="ot">=</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> Fare, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> titanic)</span>
<span id="cb109-2"><a href="logistic-regression.html#cb109-2" aria-hidden="true" tabindex="-1"></a>logistic3</span>
<span id="cb109-3"><a href="logistic-regression.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb109-4"><a href="logistic-regression.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = Survived ~ Fare, family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb109-5"><a href="logistic-regression.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = titanic)</span></span>
<span id="cb109-6"><a href="logistic-regression.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb109-7"><a href="logistic-regression.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb109-8"><a href="logistic-regression.html#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)         Fare  </span></span>
<span id="cb109-9"><a href="logistic-regression.html#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    -0.80666      0.01109  </span></span>
<span id="cb109-10"><a href="logistic-regression.html#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb109-11"><a href="logistic-regression.html#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1042 Total (i.e. Null);  1041 Residual</span></span>
<span id="cb109-12"><a href="logistic-regression.html#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1402 </span></span>
<span id="cb109-13"><a href="logistic-regression.html#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 1337  AIC: 1341</span></span></code></pre></div>
<p>The coefficient and intercept estimates give us the following equation:</p>
<p><span class="math display">\[ \text{logit}(p) = -0.80666  + 0.01109 \cdot \text{fare} \]</span></p>
<p>In this case, the estimated coefficient for the <strong>intercept</strong> is the log odds of a passenger with a fare of zero surviving the accident. Of course, there is nothing like a free lunch. So the intercept in this model corresponds to the log odds of survival when fare is at the hypothetical value of zero.</p>
<p>How do we interpret the <strong>slope</strong> coefficient for <code>Fare</code>? Let’s fix <code>Fare</code> at some value, e.g. the mean which roughly equals 37 (rounded to 0 decimals). Then the conditional logit of surviving when the fare is equal to the mean is:</p>
<!-- -0.3964565 -->
<!-- ## ```{r, eval=TRUE, echo=TRUE} -->
<!-- ## logistic3$coefficients[1] + logistic3$coefficients[2] * mean(titanic$Fare) -->
<!-- ## ``` -->
<!-- When the fare is held at 36, the conditional logit of surviving is: -0.3897711 -->
<p><span class="math display">\[\begin{aligned}
\text{logit}(p | \text{fare}=36) &amp;= -0.3964565  \\
\text{logit}(p | \text{fare}=37) &amp;= -0.38537  \\
\end{aligned}\]</span></p>
<p>We can examine the effect of a <strong>one-unit increase</strong> in fare by taking the difference of the two equations:</p>
<p><span class="math display">\[\text{logit}(p | \text{fare}=37) - \text{logit}(p | \text{fare}=36) = 0.0110866  \]</span></p>
<p>In other words, for a one-unit increase in the fare price, the expected change in log odds is 0.0110866. Can we translate this change in log odds to the change in odds? Indeed, we can. Recall that logarithm converts multiplication and division to addition and subtraction. Its inverse, the exponentiation converts addition and subtraction back to multiplication and division. If we exponentiate both sides of our last equation, we have the following:</p>
<p><span class="math display">\[ e^{\text{logit}(p | \text{fare}=37) - \text{logit}(p | \text{fare}=36)} = e^{0.0110866} =  1.011148  \]</span></p>
<p>So we can say for a one-unit increase in fare price, we expect to see about 1.1% increase in the odds of surviving. This 1.1% of increase does not depend on the value that fare is held at.</p>
<details>
<summary>
Information about Britain’s currency at that time.
</summary>
Before Britain’s currency was in terms of pounds and pence, it was in terms of pounds, shillings and pennies e.g. £18 15s 9d. There were: 12 pennies per shilling and 20 shillings per pound.
</details>
<p><br></p>
<p>Can we get this information more directly? Yes, we can.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="logistic-regression.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(MASS)</span>
<span id="cb110-2"><a href="logistic-regression.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="fu">coef</span>(logistic3), <span class="fu">confint</span>(logistic3)))  </span>
<span id="cb110-3"><a href="logistic-regression.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                           2.5 %    97.5 %</span></span>
<span id="cb110-4"><a href="logistic-regression.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.4463467 0.3780949 0.5250284</span></span>
<span id="cb110-5"><a href="logistic-regression.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fare        1.0111482 1.0080791 1.0145089</span></span></code></pre></div>
<!-- ## We can say now that the coefficient for fare is the difference in the log odds. -->
<!-- ## In other words, for a one-unit increase in the fare, the expected change in log odds is 0.011493. -->
<!-- ## exp[log(p/(1-p))(fare=34)-log(p/(1-p))(fare=33)] = -->
<!-- ## exp(log(p/(1-p))(fare=34)) / exp(log(p/(1-p))(fare=33)) = -->
<!-- ## odds(fare=34)/odds(fare=33) = -->
<!-- ## exp(0.011493) = 1.011559 -->
<!-- ## So we can say for a one-unit increase in fare, -->
<!-- ## we expect to see about 2% increase in the odds of surviving. -->
<!-- ## This 2% of increase does not depend on the value that fare is held at. -->
<!-- ## (model is linear in parameters) -->
</div>
<div id="the-bigger-picture" class="section level4 hasAnchor" number="9.3.0.3">
<h4><span class="header-section-number">9.3.0.3</span> The Bigger Picture<a href="logistic-regression.html#the-bigger-picture" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we take another subset, since <code>PassengerId</code>, <code>Name</code> and <code>Ticket</code> are not good predictors.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="logistic-regression.html#cb111-1" aria-hidden="true" tabindex="-1"></a>logistic4 <span class="ot">=</span> <span class="fu">glm</span>(Survived <span class="sc">~</span> ., <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="at">data =</span> titanic[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>)]) </span>
<span id="cb111-2"><a href="logistic-regression.html#cb111-2" aria-hidden="true" tabindex="-1"></a>logistic4</span>
<span id="cb111-3"><a href="logistic-regression.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-4"><a href="logistic-regression.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = Survived ~ ., family = binomial(link = &quot;logit&quot;), </span></span>
<span id="cb111-5"><a href="logistic-regression.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     data = titanic[, -c(1, 3, 8)])</span></span>
<span id="cb111-6"><a href="logistic-regression.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-7"><a href="logistic-regression.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb111-8"><a href="logistic-regression.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)      Pclass2      Pclass3      Sexmale          Age        SibSp  </span></span>
<span id="cb111-9"><a href="logistic-regression.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    4.386959    -1.149070    -2.085981    -3.689634    -0.035951    -0.318940  </span></span>
<span id="cb111-10"><a href="logistic-regression.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Parch         Fare    EmbarkedQ    EmbarkedS  </span></span>
<span id="cb111-11"><a href="logistic-regression.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   -0.116273     0.001661    -0.282530    -0.178047  </span></span>
<span id="cb111-12"><a href="logistic-regression.html#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-13"><a href="logistic-regression.html#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 1042 Total (i.e. Null);  1033 Residual</span></span>
<span id="cb111-14"><a href="logistic-regression.html#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       1402 </span></span>
<span id="cb111-15"><a href="logistic-regression.html#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 784   AIC: 804</span></span></code></pre></div>
<p>For example, increase one unit in age will decrease the log odd of survival by 0.0257; being a male will decrease the log odd of survival by 3.78 compared to female; and being in class2 will decrease the log odd of survival by 1.17, being in class3 will decrease the log odd of survival by 1.97.</p>
<p>Moreover, exponentiate the model coefficients can look at the result and interpret its meaning at a different angle. Below are table of the “odd ratio” value for each predictor coefficient relative to the survival and their respective 95% confident interval odd ratio value.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="logistic-regression.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(logistic4)))  </span>
<span id="cb112-2"><a href="logistic-regression.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      OR</span></span>
<span id="cb112-3"><a href="logistic-regression.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 80.39557659</span></span>
<span id="cb112-4"><a href="logistic-regression.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pclass2      0.31693150</span></span>
<span id="cb112-5"><a href="logistic-regression.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pclass3      0.12418529</span></span>
<span id="cb112-6"><a href="logistic-regression.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sexmale      0.02498115</span></span>
<span id="cb112-7"><a href="logistic-regression.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Age          0.96468745</span></span>
<span id="cb112-8"><a href="logistic-regression.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SibSp        0.72691919</span></span>
<span id="cb112-9"><a href="logistic-regression.html#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parch        0.89023213</span></span>
<span id="cb112-10"><a href="logistic-regression.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fare         1.00166223</span></span>
<span id="cb112-11"><a href="logistic-regression.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EmbarkedQ    0.75387421</span></span>
<span id="cb112-12"><a href="logistic-regression.html#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EmbarkedS    0.83690291</span></span></code></pre></div>
<p>Now, the result can be interpreted as: for a unit increase in age, the odds of surviving from the incident decrease by a factor of 0.96; and being a third class (class3), the odds of surviving decrease by a factor of 0.12, etc.</p>
<!-- The overall survival rate for men was 20%. For women, it was 74%, and for children, 52% -->
<div class="infobox2 information">
<p>The logit model coefficients can be presented as <strong>odds ratios</strong>. But odds-ratios are often misinterpreted as if they were relative risks/probabilities. Nonetheless presenting odds-ratios is standard practice in the medical literature.</p>
</div>
</div>
<div id="marginal-effects" class="section level4 hasAnchor" number="9.3.0.4">
<h4><span class="header-section-number">9.3.0.4</span> Marginal Effects<a href="logistic-regression.html#marginal-effects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<!-- https://stats.stackexchange.com/questions/147612/interpretation-of-marginal-effects-in-logit-model-with-log-timesindependent-va -->
<!-- https://www.youtube.com/watch?v=lJMO5kqWwIo -->
<p>Marginal effects is a way of presenting results as differences in probabilities, which is more informative than odds-ratios and relative risk. For continuous variables this represents the instantaneous change given that the ‘unit’ may be very small. For binary variables, the change is from 0 to 1, so one ‘unit’ as it is usually thought.</p>
<p>In order to express the more intuitive change in the predicted probability that the outcome equals 1 requires conditioning on all other included variables (i.e., selecting a set of values for all righthand-side variables) and running that set of values through the link function to convert log-odds to probabilities, thus making the marginal effect (in probability terms) of one variable a function of all other variables included in the model.</p>
<div class="infobox2 information">
<p><strong>Marginal effects</strong> show the change in probability when the predictor or independent variable increases by one unit.</p>
</div>
<p><!-- This is the definition of semi-elasticity, and can be interpreted as the -->
<!-- change in probability for a 1% change in x. --></p>
<p><!-- So we can say for a one-percent increase in fare, -->
<!-- we expect to see about 0.002544 increase in the probability of surviving -->
<!-- on a scale from 0 to 1. -->
<!-- We could also infer that a 10% price increase increases survival probability -->
<!-- by about 0.025 --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="logistic-regression.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb113-2"><a href="logistic-regression.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">margins</span>(logistic4))</span>
<span id="cb113-3"><a href="logistic-regression.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     factor     AME     SE        z      p   lower   upper</span></span>
<span id="cb113-4"><a href="logistic-regression.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Age -0.0041 0.0008  -4.9342 0.0000 -0.0057 -0.0025</span></span>
<span id="cb113-5"><a href="logistic-regression.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  EmbarkedQ -0.0324 0.0560  -0.5783 0.5631 -0.1422  0.0774</span></span>
<span id="cb113-6"><a href="logistic-regression.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  EmbarkedS -0.0206 0.0288  -0.7153 0.4744 -0.0769  0.0358</span></span>
<span id="cb113-7"><a href="logistic-regression.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Fare  0.0002 0.0002   0.7743 0.4387 -0.0003  0.0007</span></span>
<span id="cb113-8"><a href="logistic-regression.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Parch -0.0133 0.0130  -1.0264 0.3047 -0.0387  0.0121</span></span>
<span id="cb113-9"><a href="logistic-regression.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Pclass2 -0.1584 0.0423  -3.7412 0.0002 -0.2414 -0.0754</span></span>
<span id="cb113-10"><a href="logistic-regression.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Pclass3 -0.2656 0.0427  -6.2205 0.0000 -0.3493 -0.1819</span></span>
<span id="cb113-11"><a href="logistic-regression.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Sexmale -0.6608 0.0253 -26.0847 0.0000 -0.7104 -0.6111</span></span>
<span id="cb113-12"><a href="logistic-regression.html#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      SibSp -0.0365 0.0134  -2.7134 0.0067 -0.0629 -0.0101</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="logistic-regression.html#cb114-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/titanic.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-151"></span>
<img src="images/titanic.png" alt="\label{fig:titanic}Figure 4: RMS Titanic." width="50%" />
<p class="caption">
Figure 9.1: Figure 4: RMS Titanic.
</p>
</div>
<!-- #### Odds Ratio -->
<!-- ::: {.infobox2 .information data-latex="warning"} -->
<!-- The **Odds Ratio** (OR) is a measure of association between an exposure and an outcome. -->
<!-- ::: -->
<!-- <!-- https://www.theanalysisfactor.com/why-use-odds-ratios/ -->
<!-- <!-- The problem is that probability and odds have different properties that give odds some advantages in statistics. For example, -->
<!-- In logistic regression the odds ratio represents the constant effect of a predictor X, on the likelihood that one outcome will occur. The key phrase here is constant effect. In regression models, we often want a measure of the unique effect of each X on Y. If we try to express the effect of X on the likelihood of a categorical Y having a specific value through probability, the effect is not constant. What that means is there is no way to express in one number how X affects Y in terms of probability. The effect of X on the probability of Y has different values depending on the value of X. -->
<!-- So we can get the odds ratio by exponentiating the coefficient for female. Most statistical packages display both the raw regression coefficients and -->
<!--  the exponentiated coefficients for logistic regression models. -->
<!-- ```{r, eval=TRUE, echo=TRUE} -->
<!-- exp(coef(logistic1)) -->
<!-- ``` -->

</div>
</div>
<div id="motivation" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Motivation<a href="logistic-regression.html#motivation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- https://www.researchgate.net/post/Is_there_any_different_between_control_variable_and_moderating_variable2 -->
<!-- In many contexts, the effect of one variable on another might be allowed to vary. For example, the relationship between income and mortality is nonlinear, so the effect of an additional dollar of income on mortality is different for someone earning \$20,000/year than for someone earning $100,000/year. Or maybe the relationship between income and mortality differs depending on how many years of education you have. A marginal effects plot displays the effect of X on Y for different values of Z (or X).  -->
<!-- The plot will often include confidence intervals as well. The same code will often work if there's not an explicit interaction, but you are, for example, estimating a logit model where the effect of one variable changes with the values of the others. -->
<!-- - Interactions often have poor statistical power, and you will generally need a lot of observations to tell if the effect of X on Y is different for two given different values of Z. -->
<!-- - Make sure your graph has clearly labeled axes, so readers can tell whether your y-axis is the predicted value of Y or the marginal effect of X on Y. -->
<!-- https://www.spss-tutorials.com/spss-regression-with-moderation-interaction-effect/ -->
<p>A sports doctor routinely measures the muscle percentages of his clients. He also asks them how many hours per week they typically spend on training. Our doctor suspects that clients who train more are also more muscled. Furthermore, he thinks that the effect of training on muscularity declines with age. In multiple regression analysis, this is known as a <strong>moderation or interaction effect</strong>. The figure below illustrates it.</p>
<center>
<p><img src="moderation-interaction-in-regression-diagram.png" /></p>
</center>
<div class="infobox2 information">
<p>Imagine a 34 year old student and a 49 year old professor who work out at McFit (Lenne Passage). They exercise exactly the same amount of time per week (3 day split), the same exercises (McFit usually provides multiple identical machines next to each other), the same time of the day, they take the nutritional supplements, etc. etc. everything else is constant. Do you think they will experience different results in terms of muscle gains?</p>
</div>
<p>In mathematical terms the interaction is a multiplication:</p>
<p><span class="math display">\[ muscle = training + age + training*age  \]</span></p>
</div>
<div id="load-and-merge" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Load and Merge<a href="logistic-regression.html#load-and-merge" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We analyze the details of the weight-height relationship.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="logistic-regression.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb115-2"><a href="logistic-regression.html#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="logistic-regression.html#cb115-3" aria-hidden="true" tabindex="-1"></a>pequiv <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/pequiv.dta&quot;</span>, <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">&quot;pid&quot;</span>, <span class="st">&quot;syear&quot;</span>, <span class="st">&quot;d11101&quot;</span>, <span class="st">&quot;d11102ll&quot;</span>, <span class="st">&quot;l11102&quot;</span>, <span class="st">&quot;d11104&quot;</span>)) </span>
<span id="cb115-4"><a href="logistic-regression.html#cb115-4" aria-hidden="true" tabindex="-1"></a>health <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">&quot;data/health.dta&quot;</span>, <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">&quot;pid&quot;</span>, <span class="st">&quot;syear&quot;</span>, <span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>))</span>
<span id="cb115-5"><a href="logistic-regression.html#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="logistic-regression.html#cb115-6" aria-hidden="true" tabindex="-1"></a>master <span class="ot">&lt;-</span> <span class="fu">merge</span>(pequiv, health, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;pid&quot;</span>, <span class="st">&quot;syear&quot;</span>))</span></code></pre></div>
</div>
<div id="data-manipulation" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Data Manipulation<a href="logistic-regression.html#data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Drop Stata labels, rename the variables, and create factor variables.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="logistic-regression.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb116-2"><a href="logistic-regression.html#cb116-2" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> <span class="fu">remove_all_labels</span>(master)</span>
<span id="cb116-3"><a href="logistic-regression.html#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="logistic-regression.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb116-5"><a href="logistic-regression.html#cb116-5" aria-hidden="true" tabindex="-1"></a>soep <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="logistic-regression.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">region =</span> l11102,</span>
<span id="cb116-7"><a href="logistic-regression.html#cb116-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">marital =</span> d11104,</span>
<span id="cb116-8"><a href="logistic-regression.html#cb116-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> d11101,</span>
<span id="cb116-9"><a href="logistic-regression.html#cb116-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> d11102ll) <span class="sc">%&gt;%</span></span>
<span id="cb116-10"><a href="logistic-regression.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height <span class="sc">&gt;</span> <span class="dv">0</span>, weight <span class="sc">&gt;</span> <span class="dv">0</span>, marital <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-11"><a href="logistic-regression.html#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marital =</span> <span class="fu">factor</span>(marital, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)), </span>
<span id="cb116-12"><a href="logistic-regression.html#cb116-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">region =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)),</span>
<span id="cb116-13"><a href="logistic-regression.html#cb116-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb116-14"><a href="logistic-regression.html#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="logistic-regression.html#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(soep<span class="sc">$</span>marital) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;married&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;widowed&quot;</span>, <span class="st">&quot;divorced&quot;</span>, <span class="st">&quot;separated&quot;</span>) </span>
<span id="cb116-16"><a href="logistic-regression.html#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(soep<span class="sc">$</span>region) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;west&quot;</span>, <span class="st">&quot;east&quot;</span>)</span>
<span id="cb116-17"><a href="logistic-regression.html#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(soep<span class="sc">$</span>gender) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<!-- Real data -->
<p>Inspect the data (check for missings and outliers):</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="logistic-regression.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb117-2"><a href="logistic-regression.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_summary</span>(soep[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)])</span></code></pre></div>
<div id="ikcpexnevb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ikcpexnevb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ikcpexnevb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikcpexnevb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ikcpexnevb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ikcpexnevb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikcpexnevb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ikcpexnevb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ikcpexnevb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ikcpexnevb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ikcpexnevb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ikcpexnevb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ikcpexnevb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ikcpexnevb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ikcpexnevb .gt_from_md > :first-child {
  margin-top: 0;
}

#ikcpexnevb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ikcpexnevb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ikcpexnevb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ikcpexnevb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ikcpexnevb .gt_row_group_first td {
  border-top-width: 2px;
}

#ikcpexnevb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikcpexnevb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ikcpexnevb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ikcpexnevb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikcpexnevb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikcpexnevb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ikcpexnevb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ikcpexnevb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ikcpexnevb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikcpexnevb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikcpexnevb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ikcpexnevb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ikcpexnevb .gt_left {
  text-align: left;
}

#ikcpexnevb .gt_center {
  text-align: center;
}

#ikcpexnevb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ikcpexnevb .gt_font_normal {
  font-weight: normal;
}

#ikcpexnevb .gt_font_bold {
  font-weight: bold;
}

#ikcpexnevb .gt_font_italic {
  font-style: italic;
}

#ikcpexnevb .gt_super {
  font-size: 65%;
}

#ikcpexnevb .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ikcpexnevb .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ikcpexnevb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ikcpexnevb .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ikcpexnevb .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ikcpexnevb .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N = 103,950</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">gender</td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">male</td>
<td class="gt_row gt_center">49,646 (48%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">female</td>
<td class="gt_row gt_center">54,304 (52%)</td></tr>
    <tr><td class="gt_row gt_left">age</td>
<td class="gt_row gt_center">47 (35, 62)</td></tr>
    <tr><td class="gt_row gt_left">marital</td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">married</td>
<td class="gt_row gt_center">61,332 (59%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">single</td>
<td class="gt_row gt_center">25,921 (25%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">widowed</td>
<td class="gt_row gt_center">6,205 (6.0%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">divorced</td>
<td class="gt_row gt_center">8,010 (7.7%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">separated</td>
<td class="gt_row gt_center">2,482 (2.4%)</td></tr>
    <tr><td class="gt_row gt_left">region</td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">west</td>
<td class="gt_row gt_center">80,387 (77%)</td></tr>
    <tr><td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">east</td>
<td class="gt_row gt_center">23,563 (23%)</td></tr>
    <tr><td class="gt_row gt_left">height</td>
<td class="gt_row gt_center">171 (165, 178)</td></tr>
    <tr><td class="gt_row gt_left">weight</td>
<td class="gt_row gt_center">75 (65, 86)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><sup class="gt_footnote_marks">1</sup> n (%); Median (IQR)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<div id="simple-linear-model" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Simple linear model<a href="logistic-regression.html#simple-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You learned that simple regression is almost identical to correlation between two variables.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="logistic-regression.html#cb118-1" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data=</span>soep)</span>
<span id="cb118-2"><a href="logistic-regression.html#cb118-2" aria-hidden="true" tabindex="-1"></a>simple</span>
<span id="cb118-3"><a href="logistic-regression.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-4"><a href="logistic-regression.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb118-5"><a href="logistic-regression.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ height, data = soep)</span></span>
<span id="cb118-6"><a href="logistic-regression.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-7"><a href="logistic-regression.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb118-8"><a href="logistic-regression.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       height  </span></span>
<span id="cb118-9"><a href="logistic-regression.html#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    -78.4362       0.9034</span></span></code></pre></div>
</div>
<div id="multiple-regression-with-control" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Multiple regression with control<a href="logistic-regression.html#multiple-regression-with-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regression-model" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Regression model<a href="logistic-regression.html#regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here comes multiple regression. We have seen this before:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="logistic-regression.html#cb119-1" aria-hidden="true" tabindex="-1"></a>multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height <span class="sc">+</span> gender, <span class="at">data=</span>soep)</span>
<span id="cb119-2"><a href="logistic-regression.html#cb119-2" aria-hidden="true" tabindex="-1"></a>multiple</span>
<span id="cb119-3"><a href="logistic-regression.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-4"><a href="logistic-regression.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb119-5"><a href="logistic-regression.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ height + gender, data = soep)</span></span>
<span id="cb119-6"><a href="logistic-regression.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-7"><a href="logistic-regression.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb119-8"><a href="logistic-regression.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (Intercept)        height  genderfemale  </span></span>
<span id="cb119-9"><a href="logistic-regression.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      -37.567         0.684        -6.188</span></span></code></pre></div>
</div>
<div id="visualization-parallel-slopes" class="section level3 hasAnchor" number="9.8.2">
<h3><span class="header-section-number">9.8.2</span> Visualization (parallel slopes)<a href="logistic-regression.html#visualization-parallel-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have seen parallel slopes before:</p>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-159-1.png" width="576" /></p>
<div class="infobox2 information">
<p>Conclusion: The <strong>fundamental truth</strong> is that the effect of body height on body weight is identical across gender (i.e. for males and females). Males and female are equipped (by nature) with a different starting body weight on average.</p>
</div>
</div>
</div>
<div id="multiple-regression-with-moderator" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Multiple regression with moderator<a href="logistic-regression.html#multiple-regression-with-moderator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="interaction-dummy-dummy" class="section level3 hasAnchor" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> Interaction (dummy * dummy)<a href="logistic-regression.html#interaction-dummy-dummy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://www.theanalysisfactor.com/interaction-dummy-variables-in-linear-regression/ -->
<!-- https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html -->
<!-- Categorical by categorical interactions: All the tools described here require at least one variable to be continuous. A separate vignette describes cat_plot, which handles the plotting of interactions in which all the focal predictors are categorical variables. -->
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="logistic-regression.html#cb120-1" aria-hidden="true" tabindex="-1"></a>interact0a <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> region<span class="sc">*</span>gender, <span class="at">data=</span>soep)</span>
<span id="cb120-2"><a href="logistic-regression.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interact0a)</span>
<span id="cb120-3"><a href="logistic-regression.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-4"><a href="logistic-regression.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb120-5"><a href="logistic-regression.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ region * gender, data = soep)</span></span>
<span id="cb120-6"><a href="logistic-regression.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-7"><a href="logistic-regression.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb120-8"><a href="logistic-regression.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb120-9"><a href="logistic-regression.html#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -54.401  -9.987  -2.183   7.599 165.599 </span></span>
<span id="cb120-10"><a href="logistic-regression.html#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-11"><a href="logistic-regression.html#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb120-12"><a href="logistic-regression.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                          Estimate Std. Error  t value Pr(&gt;|t|)    </span></span>
<span id="cb120-13"><a href="logistic-regression.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)              84.40098    0.07542 1119.145  &lt; 2e-16 ***</span></span>
<span id="cb120-14"><a href="logistic-regression.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; regioneast               -0.41388    0.15848   -2.612  0.00901 ** </span></span>
<span id="cb120-15"><a href="logistic-regression.html#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; genderfemale            -15.21763    0.10435 -145.826  &lt; 2e-16 ***</span></span>
<span id="cb120-16"><a href="logistic-regression.html#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; regioneast:genderfemale   1.50228    0.21919    6.854 7.24e-12 ***</span></span>
<span id="cb120-17"><a href="logistic-regression.html#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb120-18"><a href="logistic-regression.html#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb120-19"><a href="logistic-regression.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-20"><a href="logistic-regression.html#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.78 on 103946 degrees of freedom</span></span>
<span id="cb120-21"><a href="logistic-regression.html#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.2022, Adjusted R-squared:  0.2021 </span></span>
<span id="cb120-22"><a href="logistic-regression.html#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:  8780 on 3 and 103946 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>First glimpse at the <code>margins</code> package.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="logistic-regression.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb121-2"><a href="logistic-regression.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co">#margins(interact0a)</span></span>
<span id="cb121-3"><a href="logistic-regression.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">margins</span>(interact0a, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">region =</span> <span class="fu">c</span>(<span class="st">&quot;west&quot;</span>, <span class="st">&quot;east&quot;</span>))))</span>
<span id="cb121-4"><a href="logistic-regression.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        factor region      AME     SE         z      p    lower    upper</span></span>
<span id="cb121-5"><a href="logistic-regression.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  genderfemale 1.0000 -15.2176 0.1044 -145.8260 0.0000 -15.4222 -15.0131</span></span>
<span id="cb121-6"><a href="logistic-regression.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  genderfemale 2.0000 -13.7153 0.1928  -71.1532 0.0000 -14.0931 -13.3376</span></span>
<span id="cb121-7"><a href="logistic-regression.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    regioneast 1.0000   0.3709 0.1095    3.3879 0.0007   0.1563   0.5855</span></span>
<span id="cb121-8"><a href="logistic-regression.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    regioneast 2.0000   0.3709 0.1095    3.3879 0.0007   0.1563   0.5855</span></span></code></pre></div>
<p>Interaction plot from the <code>interactions</code> package.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="logistic-regression.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dedicated package makes everything easier.</span></span>
<span id="cb122-2"><a href="logistic-regression.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb122-3"><a href="logistic-regression.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_plot</span>(interact0a, <span class="at">pred =</span> gender, <span class="at">modx =</span> region)</span></code></pre></div>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-162-1.png" width="576" /></p>
</div>
<div id="interaction-categorical-dummy" class="section level3 hasAnchor" number="9.9.2">
<h3><span class="header-section-number">9.9.2</span> Interaction (categorical * dummy)<a href="logistic-regression.html#interaction-categorical-dummy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="logistic-regression.html#cb123-1" aria-hidden="true" tabindex="-1"></a>interact0b <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> marital<span class="sc">*</span>gender, <span class="at">data=</span>soep)</span>
<span id="cb123-2"><a href="logistic-regression.html#cb123-2" aria-hidden="true" tabindex="-1"></a>interact0b</span>
<span id="cb123-3"><a href="logistic-regression.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb123-4"><a href="logistic-regression.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb123-5"><a href="logistic-regression.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ marital * gender, data = soep)</span></span>
<span id="cb123-6"><a href="logistic-regression.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb123-7"><a href="logistic-regression.html#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb123-8"><a href="logistic-regression.html#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   (Intercept)                  maritalsingle  </span></span>
<span id="cb123-9"><a href="logistic-regression.html#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      85.92239                       -5.38961  </span></span>
<span id="cb123-10"><a href="logistic-regression.html#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                maritalwidowed                maritaldivorced  </span></span>
<span id="cb123-11"><a href="logistic-regression.html#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -4.34815                       -0.08313  </span></span>
<span id="cb123-12"><a href="logistic-regression.html#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              maritalseparated                   genderfemale  </span></span>
<span id="cb123-13"><a href="logistic-regression.html#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.25931                      -15.50285  </span></span>
<span id="cb123-14"><a href="logistic-regression.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    maritalsingle:genderfemale    maritalwidowed:genderfemale  </span></span>
<span id="cb123-15"><a href="logistic-regression.html#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       0.77077                        4.85503  </span></span>
<span id="cb123-16"><a href="logistic-regression.html#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  maritaldivorced:genderfemale  maritalseparated:genderfemale  </span></span>
<span id="cb123-17"><a href="logistic-regression.html#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       0.44475                        1.13259</span></span></code></pre></div>
</div>
<div id="interaction-continuous-dummy" class="section level3 hasAnchor" number="9.9.3">
<h3><span class="header-section-number">9.9.3</span> Interaction (continuous * dummy)<a href="logistic-regression.html#interaction-continuous-dummy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://r4ds.had.co.nz/model-basics.html#interactions-continuous-and-categorical -->
<!-- https://moderndive.com/6-multiple-regression.html#model4interactiontable -->
<p>Note that R automatically adds main effects if you use multiplication operator:</p>
<p>Thus <span class="math display">\[ height * female \]</span></p>
<p>translates to</p>
<p><span class="math display">\[ height + female + height*female \]</span></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="logistic-regression.html#cb124-1" aria-hidden="true" tabindex="-1"></a>interact1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height<span class="sc">*</span>gender, <span class="at">data=</span>soep)</span>
<span id="cb124-2"><a href="logistic-regression.html#cb124-2" aria-hidden="true" tabindex="-1"></a>interact1</span>
<span id="cb124-3"><a href="logistic-regression.html#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-4"><a href="logistic-regression.html#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb124-5"><a href="logistic-regression.html#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ height * gender, data = soep)</span></span>
<span id="cb124-6"><a href="logistic-regression.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-7"><a href="logistic-regression.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb124-8"><a href="logistic-regression.html#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         (Intercept)               height         genderfemale  </span></span>
<span id="cb124-9"><a href="logistic-regression.html#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            -58.7988               0.8031              37.5708  </span></span>
<span id="cb124-10"><a href="logistic-regression.html#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; height:genderfemale  </span></span>
<span id="cb124-11"><a href="logistic-regression.html#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             -0.2553</span></span></code></pre></div>
</div>
<div id="visualization-non-parallel-slopes" class="section level3 hasAnchor" number="9.9.4">
<h3><span class="header-section-number">9.9.4</span> Visualization (non-parallel slopes)<a href="logistic-regression.html#visualization-non-parallel-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://cran.r-project.org/web/packages/interactions/vignettes/interactions.html -->
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="logistic-regression.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb125-2"><a href="logistic-regression.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(interact1, <span class="at">pred =</span> height, <span class="at">modx =</span> gender,</span>
<span id="cb125-3"><a href="logistic-regression.html#cb125-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">main.title =</span> <span class="st">&quot;Each group has a different slope.&quot;</span>)</span></code></pre></div>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-165-1.png" width="576" /></p>
<div class="infobox2 information">
<p>Conclusion: The <strong>fundamental truth</strong> is that the effect of body height on body weight is similar but not identical between males and females. A boy and and girl of exact same body height who experience growth by 1cm are expected to end up with different weight gains. There is <strong>effect heterogeneity</strong>.</p>
</div>
<!-- Now it is no longer a parallel slopes model. A different slope is equivalent to a different effect of height on weight for the two genders.  -->
</div>
<div id="interaction-continuous-continuous" class="section level3 hasAnchor" number="9.9.5">
<h3><span class="header-section-number">9.9.5</span> Interaction (continuous * continuous)<a href="logistic-regression.html#interaction-continuous-continuous" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://r4ds.had.co.nz/model-basics.html#interactions-two-continuous -->
<!-- https://www.theanalysisfactor.com/3-tips-interpreting-moderation/ -->
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="logistic-regression.html#cb126-1" aria-hidden="true" tabindex="-1"></a>interact2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height<span class="sc">*</span>age, <span class="at">data=</span>soep)</span>
<span id="cb126-2"><a href="logistic-regression.html#cb126-2" aria-hidden="true" tabindex="-1"></a>interact2</span>
<span id="cb126-3"><a href="logistic-regression.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb126-4"><a href="logistic-regression.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb126-5"><a href="logistic-regression.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ height * age, data = soep)</span></span>
<span id="cb126-6"><a href="logistic-regression.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb126-7"><a href="logistic-regression.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb126-8"><a href="logistic-regression.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       height          age   height:age  </span></span>
<span id="cb126-9"><a href="logistic-regression.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -80.661777     0.861444    -0.213555     0.002397</span></span></code></pre></div>
<p>The interaction of two continuous variables is harder to interpret. We cannot set the moderator (age) equal to zero, since there is no person with an age of zero (in SOEP).</p>
</div>
<div id="visualization-non-parallel-slopes-1" class="section level3 hasAnchor" number="9.9.6">
<h3><span class="header-section-number">9.9.6</span> Visualization (non-parallel slopes)<a href="logistic-regression.html#visualization-non-parallel-slopes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are conventions to help you choose the best values of the continuous moderator for plotting predicted values. But these conventions don’t always work in every situation. For example, one convention suggested by Cohen and Cohen and popularized by Aiken and West is to use three values of the moderator: the mean, the value one standard deviation above, and the value one standard deviation below the mean. This is what interact_plot() does by default.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="logistic-regression.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(interact2, <span class="at">pred =</span> height, <span class="at">modx =</span> age)</span></code></pre></div>
<p><img src="Becoming-Fluent-In-Data_files/figure-html/unnamed-chunk-167-1.png" width="576" /></p>
<p>This shows you that interaction between two continuous variables works basically the same way as for a categorical and continuous variable. An interaction says that there’s not a fixed offset: you need to consider both values of x1 and x2 simultaneously in order to predict y.</p>
<p>You can see that even with just two continuous variables, coming up with good visualizations are hard. But that’s reasonable: you shouldn’t expect it will be easy to understand how three or more variables simultaneously interact! But again, we’re saved a little because we’re using models for exploration, and you can gradually build up your model over time. The model doesn’t have to be perfect, it just has to help you reveal a little more about your data.</p>
<div class="infobox2 information">
<p>Conclusion: The <strong>fundamental truth</strong> is that the effect of body height on body weight is identical across age. In the regression output age has non-significant coefficients. The interaction plot is suggesting that there is no effect heterogeneity with respect to age (multiple parallel slopes).</p>
</div>
</div>
</div>
<div id="marginal-effects-1" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Marginal Effects<a href="logistic-regression.html#marginal-effects-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we better understand that the effect of our main explanatory variable might be increased or decreased by another variable. Still, a question is open to answer: What exactly is the effect of our main explanatory variable in the interaction model?</p>
<div class="infobox2 information">
<p>In OLS framework <strong>regression coefficients</strong> have direct interpretation as <strong>unconditional marginal effects</strong>: predicted change in y due to a unit change in x. Interactions or higher-order terms (e.g. age square) make interpretation difficult or impossible. For interpretation of the effect and the statistical significance, we have to investigate all interacted variables at the same time. Marginal effects are <strong>partial derivatives</strong> of the regression equation with respect to a variable from the model.</p>
</div>
<p><span class="math display">\[
\begin{align}
weight &amp;= \beta_0 + \beta_1 \cdot height \tag{simple regression} \\
\frac{\partial weight}{\partial height} &amp;= \beta_1 \tag{unconditional effect}  \\
weight &amp;= \beta_0 + \beta_1 \cdot height + \beta_2 \cdot female + \beta_3 \cdot height \cdot female \tag{moderated regression} \\
\frac{\partial weight}{\partial height} &amp;= \beta_1 + \beta_3 \cdot female \tag{conditional effect}  \\
\end{align}
\]</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="logistic-regression.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb128-2"><a href="logistic-regression.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(simple, interact1, <span class="at">type=</span><span class="st">&quot;text&quot;</span>)</span>
<span id="cb128-3"><a href="logistic-regression.html#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb128-4"><a href="logistic-regression.html#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb128-5"><a href="logistic-regression.html#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                          Dependent variable:                     </span></span>
<span id="cb128-6"><a href="logistic-regression.html#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     -------------------------------------------------------------</span></span>
<span id="cb128-7"><a href="logistic-regression.html#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                weight                            </span></span>
<span id="cb128-8"><a href="logistic-regression.html#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  (1)                            (2)              </span></span>
<span id="cb128-9"><a href="logistic-regression.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------------------------------</span></span>
<span id="cb128-10"><a href="logistic-regression.html#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; height                         0.903***                       0.803***           </span></span>
<span id="cb128-11"><a href="logistic-regression.html#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                (0.005)                        (0.008)            </span></span>
<span id="cb128-12"><a href="logistic-regression.html#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb128-13"><a href="logistic-regression.html#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; genderfemale                                                 37.571***           </span></span>
<span id="cb128-14"><a href="logistic-regression.html#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               (2.125)            </span></span>
<span id="cb128-15"><a href="logistic-regression.html#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb128-16"><a href="logistic-regression.html#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; height:genderfemale                                          -0.255***           </span></span>
<span id="cb128-17"><a href="logistic-regression.html#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               (0.012)            </span></span>
<span id="cb128-18"><a href="logistic-regression.html#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb128-19"><a href="logistic-regression.html#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Constant                      -78.436***                     -58.799***          </span></span>
<span id="cb128-20"><a href="logistic-regression.html#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                (0.799)                        (1.508)            </span></span>
<span id="cb128-21"><a href="logistic-regression.html#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb128-22"><a href="logistic-regression.html#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------------------------------</span></span>
<span id="cb128-23"><a href="logistic-regression.html#cb128-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observations                   103,950                        103,950            </span></span>
<span id="cb128-24"><a href="logistic-regression.html#cb128-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2                              0.267                          0.289             </span></span>
<span id="cb128-25"><a href="logistic-regression.html#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adjusted R2                     0.266                          0.289             </span></span>
<span id="cb128-26"><a href="logistic-regression.html#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Std. Error      14.170 (df = 103948)           13.955 (df = 103946)     </span></span>
<span id="cb128-27"><a href="logistic-regression.html#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F Statistic         37,767.980*** (df = 1; 103948) 14,056.330*** (df = 3; 103946)</span></span>
<span id="cb128-28"><a href="logistic-regression.html#cb128-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb128-29"><a href="logistic-regression.html#cb128-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note:                                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<p>For the simple regression, the coefficient is identical (unconditional).</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="logistic-regression.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb129-2"><a href="logistic-regression.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">margins</span>(simple)</span>
<span id="cb129-3"><a href="logistic-regression.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  height</span></span>
<span id="cb129-4"><a href="logistic-regression.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.9034</span></span></code></pre></div>
<div id="marginal-effects-at-representatives-task" class="section level3 hasAnchor" number="9.10.1">
<h3><span class="header-section-number">9.10.1</span> Marginal effects at representatives (TASK)<a href="logistic-regression.html#marginal-effects-at-representatives-task" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use representative values which we literally plug in the equation. These are the effects for each group (what we have seen before in the interaction plot):</p>
<p><span class="math display">\[
\begin{align}
weight &amp;= \beta_0 + \beta_1 \cdot height + \beta_2 \cdot female + \beta_3 \cdot height \cdot female \tag{interact1} \\
\frac{\partial weight}{\partial height} &amp;= \beta_1 + \beta_3 \cdot female \tag{conditional effect}  \\
\end{align}
\]</span></p>
<!-- \frac{\partial weight}{\partial height} &= 1.069 -0.224 \cdot 1 = 0.845 \tag{effect for males}  \\ -->
<!-- \frac{\partial weight}{\partial height} &= 1.069 -0.224 \cdot 2 = 0.621 \tag{effect for females}  \\ -->
<p>Here is the R code:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="logistic-regression.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">margins</span>(interact1, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">gender =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)))</span>
<span id="cb130-2"><a href="logistic-regression.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  at(gender) height genderfemale</span></span>
<span id="cb130-3"><a href="logistic-regression.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        male 0.8031       -6.224</span></span>
<span id="cb130-4"><a href="logistic-regression.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      female 0.5479       -6.224</span></span></code></pre></div>
<p>Please calculate the MER of height in <code>interact1</code> for the two gender programmtic in R.</p>
</div>
<div id="marginal-effects-at-the-mean-task" class="section level3 hasAnchor" number="9.10.2">
<h3><span class="header-section-number">9.10.2</span> Marginal effects at the mean (TASK)<a href="logistic-regression.html#marginal-effects-at-the-mean-task" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plugging in values is not always as easy as it seems to be. What should we use for age? Values as 0, 1 or 2 does not makes sense for age. Okay, we could use some representative age, e.g. 30 and 40. But what is our theoretical justification to report the effect for age 30 and not age 31? Another strategy is to use mean values of the variables.</p>
<!-- \frac{\partial weight}{\partial height} &= 0.9318 + 0.0009254 \cdot 48.57654 = 0.97675 \tag{ME at means}  \\ -->
<p><span class="math display">\[
\begin{align}
weight &amp;= \beta_0 + \beta_1 \cdot height + \beta_2 \cdot age + \beta_3 \cdot height \cdot age \tag{interact2} \\
\frac{\partial weight}{\partial height} &amp;= \beta_1 + \beta_3 \cdot age \tag{conditional effect}  \\
\end{align}
\]</span></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="logistic-regression.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)</span>
<span id="cb131-2"><a href="logistic-regression.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(simple, interact2, <span class="at">type=</span><span class="st">&quot;text&quot;</span>)</span>
<span id="cb131-3"><a href="logistic-regression.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb131-4"><a href="logistic-regression.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb131-5"><a href="logistic-regression.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                          Dependent variable:                     </span></span>
<span id="cb131-6"><a href="logistic-regression.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     -------------------------------------------------------------</span></span>
<span id="cb131-7"><a href="logistic-regression.html#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                weight                            </span></span>
<span id="cb131-8"><a href="logistic-regression.html#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  (1)                            (2)              </span></span>
<span id="cb131-9"><a href="logistic-regression.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------------------------------</span></span>
<span id="cb131-10"><a href="logistic-regression.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; height                         0.903***                       0.861***           </span></span>
<span id="cb131-11"><a href="logistic-regression.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                (0.005)                        (0.013)            </span></span>
<span id="cb131-12"><a href="logistic-regression.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb131-13"><a href="logistic-regression.html#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age                                                          -0.214***           </span></span>
<span id="cb131-14"><a href="logistic-regression.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               (0.044)            </span></span>
<span id="cb131-15"><a href="logistic-regression.html#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb131-16"><a href="logistic-regression.html#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; height:age                                                    0.002***           </span></span>
<span id="cb131-17"><a href="logistic-regression.html#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                               (0.0003)           </span></span>
<span id="cb131-18"><a href="logistic-regression.html#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb131-19"><a href="logistic-regression.html#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Constant                      -78.436***                     -80.662***          </span></span>
<span id="cb131-20"><a href="logistic-regression.html#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                (0.799)                        (2.214)            </span></span>
<span id="cb131-21"><a href="logistic-regression.html#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                                  </span></span>
<span id="cb131-22"><a href="logistic-regression.html#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------------------------------------</span></span>
<span id="cb131-23"><a href="logistic-regression.html#cb131-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Observations                   103,950                        103,950            </span></span>
<span id="cb131-24"><a href="logistic-regression.html#cb131-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2                              0.267                          0.309             </span></span>
<span id="cb131-25"><a href="logistic-regression.html#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adjusted R2                     0.266                          0.309             </span></span>
<span id="cb131-26"><a href="logistic-regression.html#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Std. Error      14.170 (df = 103948)           13.751 (df = 103946)     </span></span>
<span id="cb131-27"><a href="logistic-regression.html#cb131-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F Statistic         37,767.980*** (df = 1; 103948) 15,516.970*** (df = 3; 103946)</span></span>
<span id="cb131-28"><a href="logistic-regression.html#cb131-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =================================================================================</span></span>
<span id="cb131-29"><a href="logistic-regression.html#cb131-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note:                                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<p>Here is the R code with margins:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="logistic-regression.html#cb132-1" aria-hidden="true" tabindex="-1"></a>interact2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height<span class="sc">*</span>age, <span class="at">data=</span>soep)</span>
<span id="cb132-2"><a href="logistic-regression.html#cb132-2" aria-hidden="true" tabindex="-1"></a>interact2</span>
<span id="cb132-3"><a href="logistic-regression.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb132-4"><a href="logistic-regression.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb132-5"><a href="logistic-regression.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = weight ~ height * age, data = soep)</span></span>
<span id="cb132-6"><a href="logistic-regression.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb132-7"><a href="logistic-regression.html#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb132-8"><a href="logistic-regression.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       height          age   height:age  </span></span>
<span id="cb132-9"><a href="logistic-regression.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -80.661777     0.861444    -0.213555     0.002397</span></span>
<span id="cb132-10"><a href="logistic-regression.html#cb132-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-11"><a href="logistic-regression.html#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(margins(interact2))</span></span>
<span id="cb132-12"><a href="logistic-regression.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="fu">margins</span>(interact2, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">age =</span> mean_age))</span>
<span id="cb132-13"><a href="logistic-regression.html#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  at(age) height    age</span></span>
<span id="cb132-14"><a href="logistic-regression.html#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    48.05 0.9766 0.1977</span></span></code></pre></div>
<p>Please calculate the MEM of height in <code>interact2</code> programmtic in R.</p>
</div>
<div id="average-marginal-effects" class="section level3 hasAnchor" number="9.10.3">
<h3><span class="header-section-number">9.10.3</span> Average marginal effects<a href="logistic-regression.html#average-marginal-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The default <em>margins</em> commands shows you something else than MER and MEM, namely <strong>average marginal effects</strong>. AMEs calculate marginal effects at every observed value of X and average across the resulting effect estimates. AMEs are particularly useful because – unlike MEMs – produce a single quantity summary that reflects the full distribution of X rather than an arbitrary prediction.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="logistic-regression.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">margins</span>(interact1)</span>
<span id="cb133-2"><a href="logistic-regression.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  height genderfemale</span></span>
<span id="cb133-3"><a href="logistic-regression.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.6698       -6.224</span></span></code></pre></div>
<p>A summary provides you with information that cannot easily be calculated by hand, e.g. standard error, p-value, confidence interval:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="logistic-regression.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">margins</span>(interact1))</span>
<span id="cb134-2"><a href="logistic-regression.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        factor     AME     SE        z      p   lower   upper</span></span>
<span id="cb134-3"><a href="logistic-regression.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  genderfemale -6.2236 0.1169 -53.2405 0.0000 -6.4527 -5.9945</span></span>
<span id="cb134-4"><a href="logistic-regression.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        height  0.6698 0.0062 107.8003 0.0000  0.6576  0.6820</span></span></code></pre></div>
<!-- ## Personal Project (6 pt) -->
<!-- Please think about a reasonable 2x2 interaction for your topic (continuous and dummy or continuous). Please build the model and store it as `my_interaction`. Please visualize the interaction in a plot. Are there heterogeneous effects? Do they behave as expected?  -->

</div>
</div>
</div>
<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://https-marcokuehne-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fixed-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Becoming Fluent In Data.pdf", "Becoming Fluent In Data.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": false
},
"toc_depth": 1,
"toc-title": "Table of Contents",
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
